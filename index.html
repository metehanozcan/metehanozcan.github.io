<!DOCTYPE html>
<html lang="tr" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#5D5CDE">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Crypto Signals">
    <title>Advanced Multi-Pair Crypto Trading Signals</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/date-fns@2.29.3/index.min.js"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#F0B90B',
                        secondary: '#FCD535',
                        accent: '#181A20',
                        'bg-light': '#FFFFFF',
                        'bg-dark': '#181A20'
                    },
                    animation: {
                        'bounce-soft': 'bounce 2s infinite',
                        'pulse-soft': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'slide-up': 'slideUp 0.3s ease-out',
                        'slide-down': 'slideDown 0.3s ease-out'
                    },
                    screens: {
                        'xs': '375px'
                    }
                }
            }
        }
    </script>
    <style>
        /* Enhanced mobile styles */
        .notification-success {
            background: linear-gradient(135deg, #10B981, #059669);
        }
        .notification-danger {
            background: linear-gradient(135deg, #EF4444, #DC2626);
        }
        .notification-warning {
            background: linear-gradient(135deg, #F59E0B, #D97706);
        }
        .pulse-ring {
            animation: pulse-ring 1.25s cubic-bezier(0.215, 0.61, 0.355, 1) infinite;
        }
        @keyframes pulse-ring {
            0% { transform: scale(0.33); }
            80%, 100% { opacity: 0; }
        }
        .pair-card {
            transition: all 0.3s ease;
            touch-action: manipulation;
        }
        .pair-card:hover {
            transform: translateY(-2px);
        }
        .pair-card:active {
            transform: translateY(0px);
        }
        .signal-animation {
            animation: signalPulse 0.6s ease-in-out;
        }
        @keyframes signalPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        @keyframes slideUp {
            from { transform: translateY(100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        @keyframes slideDown {
            from { transform: translateY(-100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        .chart-container {
            background: white;
            border-radius: 12px;
            overflow: hidden;
        }
        .dark .chart-container {
            background: #1f2937;
        }
        .sound-wave {
            animation: soundWave 0.8s ease-in-out;
        }
        @keyframes soundWave {
            0%, 100% { transform: scale(1); }
            25% { transform: scale(1.1); }
            50% { transform: scale(1.2); }
            75% { transform: scale(1.1); }
        }
        
        /* Enhanced scrollbars */
        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f5f9;
        }
        .dark .custom-scrollbar::-webkit-scrollbar-track {
            background: #374151;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 3px;
        }
        .dark .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #6b7280;
        }
        
        /* Mobile-specific enhancements */
        @media (max-width: 768px) {
            .mobile-grid {
                grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            }
            .mobile-padding {
                padding: 1rem;
            }
            .mobile-text {
                font-size: 0.875rem;
            }
            .mobile-button {
                min-height: 44px;
                min-width: 44px;
            }
            .mobile-card {
                margin-bottom: 0.75rem;
            }
        }
        
        /* Touch-friendly elements */
        .touch-target {
            min-height: 44px;
            min-width: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* Swipe indicators */
        .swipe-indicator {
            position: relative;
        }
        .swipe-indicator::after {
            content: '‚¨ÖÔ∏è Swipe';
            position: absolute;
            right: 0.5rem;
            top: 50%;
            transform: translateY(-50%);
            font-size: 0.75rem;
            opacity: 0.5;
            animation: pulse 2s infinite;
        }
        
        /* Enhanced performance indicators */
        .performance-positive {
            background: linear-gradient(135deg, #10B981, #059669);
        }
        .performance-negative {
            background: linear-gradient(135deg, #EF4444, #DC2626);
        }
        .performance-neutral {
            background: linear-gradient(135deg, #6B7280, #4B5563);
        }
        
        /* Loading states */
        .skeleton {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }
        .dark .skeleton {
            background: linear-gradient(90deg, #374151 25%, #4B5563 50%, #374151 75%);
            background-size: 200% 100%;
        }
        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
        
        /* Bottom navigation for mobile */
        .bottom-nav {
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.9);
        }
        .dark .bottom-nav {
            background: rgba(24, 24, 24, 0.9);
        }
        
        /* Pull to refresh indicator */
        .pull-to-refresh {
            transition: all 0.3s ease;
        }
        
        /* Modern Toggle Switches */
        .toggle-switch {
            position: relative;
            transition: background-color 0.3s;
        }
        .toggle-switch.active {
            background-color: #10B981;
        }
        .toggle-switch.active .toggle-dot {
            transform: translateX(20px);
        }
        
        /* Modern Range Sliders */
        .slider {
            -webkit-appearance: none;
            appearance: none;
            background: transparent;
            cursor: pointer;
        }
        .slider::-webkit-slider-track {
            background: #d1d5db;
            height: 4px;
            border-radius: 2px;
        }
        .dark .slider::-webkit-slider-track {
            background: #4b5563;
        }
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            height: 16px;
            width: 16px;
            border-radius: 50%;
            background: #F0B90B;
            cursor: pointer;
            border: 2px solid #ffffff;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        .slider::-webkit-slider-thumb:hover {
            background: #FCD535;
            transform: scale(1.1);
        }
        .slider::-moz-range-track {
            background: #d1d5db;
            height: 4px;
            border-radius: 2px;
            border: none;
        }
        .dark .slider::-moz-range-track {
            background: #4b5563;
        }
        .slider::-moz-range-thumb {
            height: 16px;
            width: 16px;
            border-radius: 50%;
            background: #F0B90B;
            cursor: pointer;
            border: 2px solid #ffffff;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        /* Enhanced Alert Cards */
        .alert-card {
            background: linear-gradient(135deg, #FEF3C7, #FDE68A);
            border-left: 4px solid #F59E0B;
        }
        .dark .alert-card {
            background: linear-gradient(135deg, #92400E, #B45309);
            border-left: 4px solid #F59E0B;
        }
    </style>
</head>
<body class="h-full bg-bg-light dark:bg-bg-dark text-gray-900 dark:text-white transition-colors duration-200 overflow-x-hidden">
    <!-- PWA Install Banner -->
    <div id="installBanner" class="hidden fixed top-0 left-0 right-0 bg-primary text-white p-3 z-50 animate-slide-down">
        <div class="flex items-center justify-between max-w-md mx-auto">
            <div class="flex items-center space-x-3">
                <span class="text-xl">üì±</span>
                <div>
                    <div class="font-semibold text-sm">Ana Ekrana Ekle</div>
                    <div class="text-xs opacity-90">Daha iyi deneyim i√ßin</div>
                </div>
            </div>
            <div class="flex space-x-2">
                <button id="installBtn" class="px-3 py-1 bg-white text-primary rounded text-sm font-medium">Ekle</button>
                <button id="dismissBanner" class="p-1 text-white/70">‚úï</button>
            </div>
        </div>
    </div>

    <div class="min-h-screen flex flex-col pb-16 md:pb-0">
        <!-- Enhanced Header -->
        <header class="bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 shadow-sm sticky top-0 z-40">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between items-center h-16">
                    <div class="flex items-center space-x-3">
                        <div class="relative">
                            <div class="w-8 h-8 bg-primary rounded-full flex items-center justify-center">
                                <span class="text-white font-bold text-sm">‚Çø</span>
                            </div>
                            <div class="absolute -top-1 -right-1 w-3 h-3 bg-green-500 rounded-full pulse-ring" id="liveIndicator"></div>
                        </div>
                        <div>
                            <h1 class="text-lg md:text-xl font-semibold">Advanced Crypto Signals</h1>
                            <div class="flex items-center space-x-2 text-xs text-gray-500">
                                <div class="bg-primary/10 text-primary px-2 py-0.5 rounded-full font-medium" id="activePairsCount">0 √ßift</div>
                                <div class="bg-green-100 dark:bg-green-900 text-green-600 px-2 py-0.5 rounded-full" id="profitability">+0%</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Desktop Controls -->
                    <div class="hidden md:flex items-center space-x-3">
                        <button id="themeToggle" class="touch-target p-2 rounded-lg bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors">
                            <svg class="w-5 h-5 dark:hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
                            </svg>
                            <svg class="w-5 h-5 hidden dark:block" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
                            </svg>
                        </button>
                        
                        <button id="soundToggle" class="touch-target p-2 rounded-lg bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors" title="Ses Ayarlarƒ±">
                            <svg class="w-5 h-5" id="soundIcon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 14.142M5 7h4l5-5v16l-5-5H5a2 2 0 01-2-2V9a2 2 0 012-2z"></path>
                            </svg>
                        </button>
                        
                        <button id="notificationBtn" class="px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg font-medium transition-colors text-sm flex items-center space-x-2">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-5 5v-5z"></path>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 19H6.5A2.5 2.5 0 0 1 4 16.5v-9A2.5 2.5 0 0 1 6.5 5h11A2.5 2.5 0 0 1 20 7.5v4"></path>
                            </svg>
                            <span>Bildirimler</span>
                        </button>

                        <button id="portfolioBtn" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors text-sm flex items-center space-x-2">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-4m-5 0H3m2 0h4M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path>
                            </svg>
                            <span>Portf√∂y</span>
                        </button>
                    </div>

                    <!-- Mobile Menu Button -->
                    <button id="mobileMenuBtn" class="md:hidden touch-target p-2 rounded-lg bg-gray-100 dark:bg-gray-700">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Mobile Menu -->
            <div id="mobileMenu" class="hidden md:hidden bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 p-4">
                <div class="grid grid-cols-2 gap-3">
                    <button id="mobileThemeToggle" class="mobile-button p-3 bg-gray-100 dark:bg-gray-700 rounded-lg flex items-center justify-center space-x-2">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
                        </svg>
                        <span class="text-sm">Tema</span>
                    </button>
                    
                    <button id="mobileSoundToggle" class="mobile-button p-3 bg-gray-100 dark:bg-gray-700 rounded-lg flex items-center justify-center space-x-2">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072M5 7h4l5-5v16l-5-5H5a2 2 0 01-2-2V9a2 2 0 012-2z"></path>
                        </svg>
                        <span class="text-sm">Ses</span>
                    </button>
                    
                    <button id="mobileNotificationBtn" class="mobile-button p-3 bg-gray-100 dark:bg-gray-700 rounded-lg flex items-center justify-center space-x-2">
                        <span class="text-sm">üîî</span>
                        <span class="text-sm">Bildirim</span>
                    </button>
                    
                    <button id="mobilePortfolioBtn" class="mobile-button p-3 bg-gray-100 dark:bg-gray-700 rounded-lg flex items-center justify-center space-x-2">
                        <span class="text-sm">üíº</span>
                        <span class="text-sm">Portf√∂y</span>
                    </button>
                </div>
            </div>
        </header>

        <main class="flex-1 max-w-7xl mx-auto w-full px-4 sm:px-6 lg:px-8 py-4 md:py-8">
            <!-- Modern Market Overview Cards -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
                <!-- Bitcoin Card -->
                <div class="bg-gradient-to-br from-orange-500 to-orange-600 rounded-2xl p-4 text-white shadow-lg hover:shadow-xl transition-all duration-300">
                    <div class="flex items-center justify-between mb-3">
                        <div class="flex items-center space-x-2">
                            <div class="w-8 h-8 bg-white/20 rounded-lg flex items-center justify-center">
                                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0zm5.568 8.16c-.396 2.538-2.096 2.54-4.245 2.046l.608-2.453c.852.21 1.741.414 1.876-.067.145-.515-.45-.689-.958-.78l.52-2.097c.608.152 1.238.311 1.335-.17.103-.512-.436-.66-.897-.743l.388-1.564-1.538-.382-.381 1.535c-.403-.099-.815-.191-1.226-.283l.385-1.548-1.538-.383-.388 1.564-.997-.239-.598 2.405 1.154.287c.431.107.509.392.496.621l-1.496 6.03c-.113.283-.398.709-.906.548l-1.158-.288-.889 2.587 1.492.37c.278.069.55.141.818.209l-.393 1.586 1.538.382.388-1.564c.421.114.829.219 1.23.318l-.385 1.548 1.538.383.393-1.582c2.332.441 4.084.263 4.82-1.849.594-1.698-.03-2.678-1.256-3.315.894-.206 1.566-.793 1.746-2.006z"/>
                                </svg>
                            </div>
                            <div>
                                <p class="text-xs font-medium opacity-90">Bitcoin</p>
                                <p class="text-xl font-bold" id="btcPrice">$0</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="flex items-center space-x-1">
                                <svg class="w-4 h-4" id="btcTrendIcon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
                                </svg>
                                <span class="text-sm font-bold" id="btcChange">0%</span>
                            </div>
                            <div class="w-16 h-8 mt-2">
                                <div class="h-full bg-white/20 rounded" id="btcSparkline"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Ethereum Card -->
                <div class="bg-gradient-to-br from-blue-500 to-purple-600 rounded-2xl p-4 text-white shadow-lg hover:shadow-xl transition-all duration-300">
                    <div class="flex items-center justify-between mb-3">
                        <div class="flex items-center space-x-2">
                            <div class="w-8 h-8 bg-white/20 rounded-lg flex items-center justify-center">
                                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M11.944 17.97L4.58 13.62 11.943 24l7.37-10.38-7.372 4.35h.003zM12.056 0L4.69 12.223l7.365 4.354 7.365-4.35L12.056 0z"/>
                                </svg>
                            </div>
                            <div>
                                <p class="text-xs font-medium opacity-90">Ethereum</p>
                                <p class="text-xl font-bold" id="ethPrice">$0</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="flex items-center space-x-1">
                                <svg class="w-4 h-4" id="ethTrendIcon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
                                </svg>
                                <span class="text-sm font-bold" id="ethChange">0%</span>
                            </div>
                            <div class="w-16 h-8 mt-2">
                                <div class="h-full bg-white/20 rounded" id="ethSparkline"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Fear & Greed Index Card -->
                <div class="bg-gradient-to-br from-green-500 to-emerald-600 rounded-2xl p-4 text-white shadow-lg hover:shadow-xl transition-all duration-300">
                    <div class="flex items-center justify-between mb-3">
                        <div class="flex items-center space-x-2">
                            <div class="w-8 h-8 bg-white/20 rounded-lg flex items-center justify-center">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                                </svg>
                            </div>
                            <div>
                                <p class="text-xs font-medium opacity-90">Fear & Greed</p>
                                <p class="text-xl font-bold" id="fearGreedIndex">50</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <span class="text-sm font-bold" id="fearGreedLabel">Neutral</span>
                            <div class="w-16 h-2 bg-white/20 rounded-full mt-2">
                                <div class="h-full bg-white rounded-full transition-all duration-500" id="fearGreedBar" style="width: 50%"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Signal Accuracy Card -->
                <div class="bg-gradient-to-br from-primary to-secondary rounded-2xl p-4 text-black shadow-lg hover:shadow-xl transition-all duration-300">
                    <div class="flex items-center justify-between mb-3">
                        <div class="flex items-center space-x-2">
                            <div class="w-8 h-8 bg-black/10 rounded-lg flex items-center justify-center">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                            </div>
                            <div>
                                <p class="text-xs font-medium opacity-75">Signal Accuracy</p>
                                <p class="text-xl font-bold" id="signalAccuracy">0%</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <span class="text-sm font-bold opacity-75" id="totalSignalsCount">0 signals</span>
                            <div class="w-16 h-2 bg-black/10 rounded-full mt-2">
                                <div class="h-full bg-black/40 rounded-full transition-all duration-500" id="accuracyBar" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Enhanced Add Pair Section -->
            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg mobile-padding border border-gray-200 dark:border-gray-700 mb-6">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-lg font-semibold flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                        </svg>
                        Yeni √áift Ekle
                    </h2>
                    <button id="presetPairsBtn" class="px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white rounded text-xs md:text-sm transition-colors">
                        ‚ö° Preset
                    </button>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-4">
                    <div>
                        <label class="block text-sm font-medium mb-2">Sembol</label>
                        <select id="symbolSelect" class="w-full px-3 py-3 text-base border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 focus:ring-2 focus:ring-primary focus:border-transparent mobile-button">
                            <option value="">Sembol Se√ßin</option>
                            <option value="btcusdt">BTC/USDT</option>
                            <option value="ethusdt">ETH/USDT</option>
                            <option value="adausdt">ADA/USDT</option>
                            <option value="bnbusdt">BNB/USDT</option>
                            <option value="solusdt">SOL/USDT</option>
                            <option value="dogeusdt">DOGE/USDT</option>
                            <option value="xrpusdt">XRP/USDT</option>
                            <option value="avaxusdt">AVAX/USDT</option>
                            <option value="dotusdt">DOT/USDT</option>
                            <option value="maticusdt">MATIC/USDT</option>
                            <option value="linkusdt">LINK/USDT</option>
                            <option value="ltcusdt">LTC/USDT</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium mb-2">Zaman Dilimi</label>
                        <select id="intervalSelect" class="w-full px-3 py-3 text-base border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 focus:ring-2 focus:ring-primary focus:border-transparent mobile-button">
                            <option value="1m">1 Dakika</option>
                            <option value="3m" selected>3 Dakika</option>
                            <option value="5m">5 Dakika</option>
                            <option value="15m">15 Dakika</option>
                            <option value="30m">30 Dakika</option>
                            <option value="1h">1 Saat</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium mb-2">EMA Ayarlarƒ±</label>
                        <div class="flex space-x-2">
                            <input type="number" id="emaShort" value="8" min="1" max="50" class="w-full px-3 py-3 text-base border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 focus:ring-2 focus:ring-primary focus:border-transparent" placeholder="8">
                            <input type="number" id="emaLong" value="55" min="1" max="200" class="w-full px-3 py-3 text-base border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 focus:ring-2 focus:ring-primary focus:border-transparent" placeholder="55">
                        </div>
                    </div>
                    
                    <div class="flex items-end">
                        <button id="addPairBtn" class="w-full mobile-button px-4 py-3 bg-primary hover:bg-primary/90 text-white rounded-lg font-medium transition-colors">
                            ‚ûï √áift Ekle
                        </button>
                    </div>
                </div>

                <!-- Quick Add Section -->
                <div class="border-t border-gray-200 dark:border-gray-600 pt-4">
                    <div class="flex flex-wrap gap-2 mb-4">
                        <button class="quick-add-btn px-3 py-1 bg-gray-100 dark:bg-gray-700 rounded-full text-sm hover:bg-primary hover:text-white transition-colors" data-symbol="btcusdt">BTC</button>
                        <button class="quick-add-btn px-3 py-1 bg-gray-100 dark:bg-gray-700 rounded-full text-sm hover:bg-primary hover:text-white transition-colors" data-symbol="ethusdt">ETH</button>
                        <button class="quick-add-btn px-3 py-1 bg-gray-100 dark:bg-gray-700 rounded-full text-sm hover:bg-primary hover:text-white transition-colors" data-symbol="solusdt">SOL</button>
                        <button class="quick-add-btn px-3 py-1 bg-gray-100 dark:bg-gray-700 rounded-full text-sm hover:bg-primary hover:text-white transition-colors" data-symbol="adausdt">ADA</button>
                        <button class="quick-add-btn px-3 py-1 bg-gray-100 dark:bg-gray-700 rounded-full text-sm hover:bg-primary hover:text-white transition-colors" data-symbol="dogeusdt">DOGE</button>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <input type="text" id="customSymbol" class="px-3 py-3 text-base border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 focus:ring-2 focus:ring-primary focus:border-transparent" placeholder="√ñzel Sembol (PEPEUSDT)">
                        <button id="addCustomPairBtn" class="mobile-button px-4 py-3 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium transition-colors">
                            √ñzel Ekle
                        </button>
                        <button id="clearAllBtn" class="mobile-button px-4 py-3 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-colors">
                            Hepsini Temizle
                        </button>
                    </div>
                </div>
            </div>

            <!-- Main Content Grid -->
            <div class="grid grid-cols-1 xl:grid-cols-4 gap-6">
                <!-- Charts and Pairs Section -->
                <div class="xl:col-span-3 space-y-6">
                    <!-- Enhanced Chart Section -->
                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 overflow-hidden">
                        <div class="p-4 border-b border-gray-200 dark:border-gray-700">
                            <div class="flex flex-col md:flex-row justify-between items-start md:items-center space-y-3 md:space-y-0">
                                <h2 class="text-lg font-semibold flex items-center">
                                    üìà Price Charts
                                    <span class="ml-2 px-2 py-1 bg-green-100 dark:bg-green-900 text-green-600 text-xs rounded-full" id="chartStatus">LIVE</span>
                                </h2>
                                <div class="flex flex-wrap items-center gap-2">
                                    <select id="chartType" class="px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 focus:ring-2 focus:ring-primary focus:border-transparent">
                                        <option value="custom">Custom Chart</option>
                                        <option value="tradingview">TradingView</option>
                                    </select>
                                    <select id="chartSymbol" class="px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 focus:ring-2 focus:ring-primary focus:border-transparent">
                                        <option value="btcusdt">BTC/USDT</option>
                                        <option value="ethusdt">ETH/USDT</option>
                                        <option value="adausdt">ADA/USDT</option>
                                        <option value="bnbusdt">BNB/USDT</option>
                                        <option value="solusdt">SOL/USDT</option>
                                    </select>
                                    <select id="chartInterval" class="px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 focus:ring-2 focus:ring-primary focus:border-transparent">
                                        <option value="1m">1m</option>
                                        <option value="3m" selected>3m</option>
                                        <option value="5m">5m</option>
                                        <option value="15m">15m</option>
                                    </select>
                                    <button id="refreshChart" class="touch-target p-2 text-gray-600 dark:text-gray-400 hover:text-primary transition-colors border border-gray-300 dark:border-gray-600 rounded" title="Grafiƒüi Yenile">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="chart-container p-4" id="customChartContainer">
                            <canvas id="priceChart" class="w-full h-64 md:h-80"></canvas>
                        </div>
                        
                        <div class="chart-container h-64 md:h-96" id="tradingViewContainer" style="display: none;">
                            <div class="tradingview-widget-container" style="height:100%;width:100%">
                                <div class="tradingview-widget-container__widget" style="height:calc(100% - 32px);width:100%" id="tradingview_widget"></div>
                                <div class="tradingview-widget-copyright">
                                    <a href="https://www.tradingview.com/" rel="noopener nofollow" target="_blank">
                                        <span class="text-blue-600 dark:text-blue-400 text-xs">Advanced Charts by TradingView</span>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Enhanced Active Pairs -->
                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg mobile-padding border border-gray-200 dark:border-gray-700">
                        <div class="flex items-center justify-between mb-6">
                            <h2 class="text-lg font-semibold">Aktif √áiftler</h2>
                            <div class="flex items-center space-x-2">
                                <button id="sortPairsBtn" class="px-3 py-1 bg-gray-500 hover:bg-gray-600 text-white rounded text-sm transition-colors flex items-center space-x-1">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"></path>
                                    </svg>
                                    <span>Sƒ±rala</span>
                                </button>
                                <button id="exportPairsBtn" class="px-3 py-1 bg-purple-600 hover:bg-purple-700 text-white rounded text-sm transition-colors flex items-center space-x-1">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                    </svg>
                                    <span>Export</span>
                                </button>
                            </div>
                        </div>
                        
                        <!-- Pairs Filter -->
                        <div class="mb-4 flex flex-wrap gap-2">
                            <button class="filter-btn active px-3 py-1 bg-primary text-white rounded-full text-sm" data-filter="all">T√ºm√º</button>
                            <button class="filter-btn px-3 py-1 bg-gray-200 dark:bg-gray-700 rounded-full text-sm" data-filter="profitable">K√¢rlƒ±</button>
                            <button class="filter-btn px-3 py-1 bg-gray-200 dark:bg-gray-700 rounded-full text-sm" data-filter="signals">Sinyalli</button>
                            <button class="filter-btn px-3 py-1 bg-gray-200 dark:bg-gray-700 rounded-full text-sm" data-filter="alerts">Alarmlar</button>
                        </div>
                        
                        <div id="activePairs" class="mobile-grid grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                            <!-- Pairs will be added here -->
                        </div>
                        
                        <div id="noPairsMessage" class="text-center py-12 text-gray-500 dark:text-gray-400">
                            <svg class="w-16 h-16 mx-auto mb-4 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                            </svg>
                            <p class="text-lg">Hen√ºz √ßift eklenmemi≈ü</p>
                            <p class="text-sm">Yukarƒ±dan yeni √ßift ekleyerek ba≈ülayƒ±n</p>
                        </div>
                    </div>
                </div>

                <!-- Enhanced Signals Panel -->
                <div class="space-y-6">
                    <!-- Performance Dashboard -->
                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 overflow-hidden">
                        <div class="bg-gradient-to-r from-primary to-secondary p-4">
                            <div class="flex items-center justify-between">
                                <h3 class="text-lg font-bold text-black flex items-center">
                                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                                    </svg>
                                    Performance Dashboard
                                </h3>
                                <button id="refreshStats" class="bg-black/20 hover:bg-black/30 text-black px-3 py-1 rounded-lg text-sm transition-colors flex items-center space-x-1">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                                    </svg>
                                    <span>Refresh</span>
                                </button>
                            </div>
                        </div>
                        
                        <div class="p-4 space-y-4">
                            <!-- Stats Cards Grid -->
                            <div class="grid grid-cols-2 gap-3">
                                <div class="bg-green-50 dark:bg-green-900/20 rounded-lg p-3 border border-green-200 dark:border-green-800">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <p class="text-xs text-green-600 dark:text-green-400 font-medium">Ba≈üarƒ±lƒ±</p>
                                            <p class="text-xl font-bold text-green-700 dark:text-green-300" id="successfulSignals">0</p>
                                        </div>
                                        <div class="w-8 h-8 bg-green-100 dark:bg-green-800 rounded-full flex items-center justify-center">
                                            <svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                            </svg>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="bg-red-50 dark:bg-red-900/20 rounded-lg p-3 border border-red-200 dark:border-red-800">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <p class="text-xs text-red-600 dark:text-red-400 font-medium">Ba≈üarƒ±sƒ±z</p>
                                            <p class="text-xl font-bold text-red-700 dark:text-red-300" id="failedSignals">0</p>
                                        </div>
                                        <div class="w-8 h-8 bg-red-100 dark:bg-red-800 rounded-full flex items-center justify-center">
                                            <svg class="w-5 h-5 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                            </svg>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="bg-blue-50 dark:bg-blue-900/20 rounded-lg p-3 border border-blue-200 dark:border-blue-800">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <p class="text-xs text-blue-600 dark:text-blue-400 font-medium">Beklemede</p>
                                            <p class="text-xl font-bold text-blue-700 dark:text-blue-300" id="pendingSignals">0</p>
                                        </div>
                                        <div class="w-8 h-8 bg-blue-100 dark:bg-blue-800 rounded-full flex items-center justify-center">
                                            <svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                            </svg>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="bg-primary/10 dark:bg-primary/20 rounded-lg p-3 border border-primary/30">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <p class="text-xs text-primary font-medium">Accuracy</p>
                                            <p class="text-xl font-bold text-primary" id="winRate">0%</p>
                                        </div>
                                        <div class="w-8 h-8 bg-primary/20 rounded-full flex items-center justify-center">
                                            <svg class="w-5 h-5 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                            </svg>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- PnL Section -->
                            <div class="bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600">
                                <div class="text-center">
                                    <p class="text-sm text-gray-600 dark:text-gray-400 mb-2">Toplam Kar/Zarar</p>
                                    <p class="text-2xl font-bold" id="totalPnL">$0.00</p>
                                    <div class="mt-2 h-2 bg-gray-200 dark:bg-gray-600 rounded-full overflow-hidden">
                                        <div class="h-full bg-gradient-to-r from-green-500 to-primary rounded-full transition-all duration-300" id="pnlProgressBar" style="width: 50%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Technical Indicators Settings -->
                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700">
                        <div class="bg-gradient-to-r from-blue-500 to-purple-600 p-4 rounded-t-xl">
                            <h3 class="text-lg font-bold text-white flex items-center">
                                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4"></path>
                                </svg>
                                Teknik ƒ∞ndikat√∂rler
                            </h3>
                        </div>
                        
                        <div class="p-4 space-y-4">
                            <!-- EMA Settings -->
                            <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-3">
                                <div class="flex items-center justify-between mb-3">
                                    <label class="text-sm font-semibold text-gray-800 dark:text-gray-200 flex items-center">
                                        üìà EMA (Exponential Moving Average)
                                    </label>
                                    <div class="relative">
                                        <input type="checkbox" id="emaEnabled" checked class="sr-only">
                                        <div class="toggle-switch w-11 h-6 bg-gray-200 dark:bg-gray-700 rounded-full shadow-inner cursor-pointer" onclick="toggleIndicator('ema')">
                                            <div class="toggle-dot absolute w-4 h-4 bg-white rounded-full shadow top-1 left-1 transition-transform duration-200 ease-in-out"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="grid grid-cols-2 gap-3" id="emaSettings">
                                    <div>
                                        <label class="block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1">Short Period</label>
                                        <input type="range" id="emaShortRange" min="5" max="50" value="8" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider">
                                        <div class="text-center text-xs text-gray-500 mt-1" id="emaShortValue">8</div>
                                    </div>
                                    <div>
                                        <label class="block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1">Long Period</label>
                                        <input type="range" id="emaLongRange" min="20" max="200" value="55" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider">
                                        <div class="text-center text-xs text-gray-500 mt-1" id="emaLongValue">55</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Bollinger Bands -->
                            <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-3">
                                <div class="flex items-center justify-between mb-3">
                                    <label class="text-sm font-semibold text-gray-800 dark:text-gray-200 flex items-center">
                                        üìä Bollinger Bands
                                    </label>
                                    <div class="relative">
                                        <input type="checkbox" id="bollingerEnabled" class="sr-only">
                                        <div class="toggle-switch w-11 h-6 bg-gray-200 dark:bg-gray-700 rounded-full shadow-inner cursor-pointer" onclick="toggleIndicator('bollinger')">
                                            <div class="toggle-dot absolute w-4 h-4 bg-white rounded-full shadow top-1 left-1 transition-transform duration-200 ease-in-out"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="grid grid-cols-2 gap-3" id="bollingerSettings" style="display: none;">
                                    <div>
                                        <label class="block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1">Period</label>
                                        <input type="range" id="bollingerPeriod" min="10" max="50" value="20" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider">
                                        <div class="text-center text-xs text-gray-500 mt-1" id="bollingerPeriodValue">20</div>
                                    </div>
                                    <div>
                                        <label class="block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1">Deviation</label>
                                        <input type="range" id="bollingerDeviation" min="1" max="3" step="0.1" value="2" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider">
                                        <div class="text-center text-xs text-gray-500 mt-1" id="bollingerDeviationValue">2.0</div>
                                    </div>
                                </div>
                            </div>

                            <!-- RSI -->
                            <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-3">
                                <div class="flex items-center justify-between mb-3">
                                    <label class="text-sm font-semibold text-gray-800 dark:text-gray-200 flex items-center">
                                        üìà RSI (Relative Strength Index)
                                    </label>
                                    <div class="relative">
                                        <input type="checkbox" id="rsiEnabled" class="sr-only">
                                        <div class="toggle-switch w-11 h-6 bg-gray-200 dark:bg-gray-700 rounded-full shadow-inner cursor-pointer" onclick="toggleIndicator('rsi')">
                                            <div class="toggle-dot absolute w-4 h-4 bg-white rounded-full shadow top-1 left-1 transition-transform duration-200 ease-in-out"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="grid grid-cols-3 gap-3" id="rsiSettings" style="display: none;">
                                    <div>
                                        <label class="block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1">Period</label>
                                        <input type="range" id="rsiPeriod" min="5" max="30" value="14" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider">
                                        <div class="text-center text-xs text-gray-500 mt-1" id="rsiPeriodValue">14</div>
                                    </div>
                                    <div>
                                        <label class="block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1">Overbought</label>
                                        <input type="range" id="rsiOverbought" min="70" max="90" value="80" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider">
                                        <div class="text-center text-xs text-gray-500 mt-1" id="rsiOverboughtValue">80</div>
                                    </div>
                                    <div>
                                        <label class="block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1">Oversold</label>
                                        <input type="range" id="rsiOversold" min="10" max="30" value="20" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider">
                                        <div class="text-center text-xs text-gray-500 mt-1" id="rsiOversoldValue">20</div>
                                    </div>
                                </div>
                            </div>

                            <!-- MACD -->
                            <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-3">
                                <div class="flex items-center justify-between mb-3">
                                    <label class="text-sm font-semibold text-gray-800 dark:text-gray-200 flex items-center">
                                        üìä MACD (Moving Average Convergence Divergence)
                                    </label>
                                    <div class="relative">
                                        <input type="checkbox" id="macdEnabled" class="sr-only">
                                        <div class="toggle-switch w-11 h-6 bg-gray-200 dark:bg-gray-700 rounded-full shadow-inner cursor-pointer" onclick="toggleIndicator('macd')">
                                            <div class="toggle-dot absolute w-4 h-4 bg-white rounded-full shadow top-1 left-1 transition-transform duration-200 ease-in-out"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="grid grid-cols-3 gap-3" id="macdSettings" style="display: none;">
                                    <div>
                                        <label class="block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1">Fast</label>
                                        <input type="range" id="macdFast" min="5" max="20" value="12" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider">
                                        <div class="text-center text-xs text-gray-500 mt-1" id="macdFastValue">12</div>
                                    </div>
                                    <div>
                                        <label class="block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1">Slow</label>
                                        <input type="range" id="macdSlow" min="20" max="35" value="26" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider">
                                        <div class="text-center text-xs text-gray-500 mt-1" id="macdSlowValue">26</div>
                                    </div>
                                    <div>
                                        <label class="block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1">Signal</label>
                                        <input type="range" id="macdSignal" min="5" max="15" value="9" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider">
                                        <div class="text-center text-xs text-gray-500 mt-1" id="macdSignalValue">9</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Apply Settings Button -->
                            <div class="pt-3 border-t border-gray-200 dark:border-gray-700">
                                <button id="applyIndicatorSettings" class="w-full bg-gradient-to-r from-primary to-secondary hover:from-primary/90 hover:to-secondary/90 text-black font-semibold py-3 px-4 rounded-lg transition-all duration-200 shadow-lg hover:shadow-xl">
                                    ‚ú® Ayarlarƒ± Uygula
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Latest Signal Enhanced -->
                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 overflow-hidden">
                        <div class="bg-gradient-to-r from-green-500 to-emerald-600 p-4">
                            <div class="flex items-center justify-between">
                                <h3 class="text-lg font-bold text-white flex items-center">
                                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                    </svg>
                                    Son Sinyal
                                </h3>
                                <div class="flex space-x-2">
                                    <button id="signalAlertBtn" class="bg-white/20 hover:bg-white/30 text-white px-3 py-1 rounded-lg text-sm transition-colors flex items-center space-x-1" title="Sinyal Alarmƒ±">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-5 5v-5z"></path>
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 19H6.5A2.5 2.5 0 0 1 4 16.5v-9A2.5 2.5 0 0 1 6.5 5h11A2.5 2.5 0 0 1 20 7.5v4"></path>
                                        </svg>
                                        <span>Alarm</span>
                                    </button>
                                    <button id="shareSignalBtn" class="bg-white/20 hover:bg-white/30 text-white px-3 py-1 rounded-lg text-sm transition-colors flex items-center space-x-1" title="Payla≈ü">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"></path>
                                        </svg>
                                        <span>Share</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="p-4">
                            <div id="latestSignalCombined" class="text-center py-8 text-gray-500 dark:text-gray-400">
                                <div class="w-16 h-16 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center mx-auto mb-4">
                                    <span class="text-2xl">üìä</span>
                                </div>
                                <p class="text-lg font-semibold">Hen√ºz sinyal yok</p>
                                <p class="text-sm">ƒ∞lk sinyal geldiƒüinde burada g√∂r√ºnecek</p>
                            </div>
                        </div>
                    </div>

                    <!-- Enhanced Signal History -->
                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 overflow-hidden">
                        <div class="bg-gradient-to-r from-purple-500 to-indigo-600 p-4">
                            <div class="flex items-center justify-between">
                                <h3 class="text-lg font-bold text-white flex items-center">
                                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                    </svg>
                                    Sinyal Ge√ßmi≈üi
                                </h3>
                                <div class="flex space-x-2">
                                    <select id="signalFilter" class="bg-white/20 border-none text-white text-sm px-3 py-1 rounded-lg focus:ring-2 focus:ring-white/50">
                                        <option value="all" class="text-gray-900">T√ºm√º</option>
                                        <option value="buy" class="text-gray-900">AL</option>
                                        <option value="sell" class="text-gray-900">SAT</option>
                                        <option value="today" class="text-gray-900">Bug√ºn</option>
                                    </select>
                                    <button id="clearHistoryBtn" class="bg-red-500/80 hover:bg-red-500 text-white px-3 py-1 rounded-lg text-sm transition-colors">
                                        <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                    </svg>
                                    Temizle
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="p-4">
                            <div id="combinedSignalHistory" class="space-y-3 max-h-80 overflow-y-auto custom-scrollbar">
                                <!-- Combined signals will be added here -->
                            </div>
                            <div id="noSignalsMessage" class="text-center py-8 text-gray-500 dark:text-gray-400">
                                <div class="w-16 h-16 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center mx-auto mb-4">
                                    <span class="text-2xl">üìä</span>
                                </div>
                                <p class="text-lg font-semibold">Hen√ºz sinyal yok</p>
                                <p class="text-sm">ƒ∞lk sinyal geldiƒüinde burada g√∂r√ºnecek</p>
                            </div>
                        </div>
                    </div>

                    <!-- Modern Price Alerts -->
                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 overflow-hidden">
                        <div class="bg-gradient-to-r from-orange-500 to-red-500 p-4">
                            <h3 class="text-lg font-bold text-white flex items-center">
                                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
                            </svg>
                            Fiyat Alarmlarƒ±
                            </h3>
                        </div>
                        
                        <div class="p-4 space-y-4">
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                                <select id="alertSymbol" class="px-4 py-3 text-base border-2 border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 focus:ring-2 focus:ring-primary focus:border-transparent transition-all">
                                    <option value="btcusdt">BTC/USDT</option>
                                    <option value="ethusdt">ETH/USDT</option>
                                    <option value="solusdt">SOL/USDT</option>
                                    <option value="adausdt">ADA/USDT</option>
                                </select>
                                <input type="number" id="alertPrice" placeholder="Hedef fiyat girin" class="px-4 py-3 text-base border-2 border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 focus:ring-2 focus:ring-primary focus:border-transparent transition-all">
                                <button id="addAlertBtn" class="px-6 py-3 bg-gradient-to-r from-primary to-secondary hover:from-primary/90 hover:to-secondary/90 text-black font-semibold rounded-lg transition-all duration-200 shadow-lg hover:shadow-xl">
                                    ‚ûï Alarm Ekle
                                </button>
                            </div>
                            
                            <div id="activeAlerts" class="space-y-3 max-h-40 overflow-y-auto custom-scrollbar">
                                <!-- Active alerts will be shown here -->
                            </div>
                            
                            <div id="noAlertsMessage" class="text-center py-6 text-gray-500 dark:text-gray-400">
                                <div class="w-12 h-12 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center mx-auto mb-3">
                                    <span class="text-xl">üîî</span>
                                </div>
                                <p class="text-sm">Hen√ºz alarm yok</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Bottom Navigation for Mobile -->
        <nav class="md:hidden fixed bottom-0 left-0 right-0 bottom-nav border-t border-gray-200 dark:border-gray-700 px-4 py-2 z-30">
            <div class="flex justify-around items-center">
                <button class="nav-item flex flex-col items-center space-y-1 p-2 rounded-lg" data-tab="pairs">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                    </svg>
                    <span class="text-xs">√áiftler</span>
                </button>
                
                <button class="nav-item flex flex-col items-center space-y-1 p-2 rounded-lg" data-tab="signals">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    <span class="text-xs">Sinyaller</span>
                </button>
                
                <button class="nav-item flex flex-col items-center space-y-1 p-2 rounded-lg" data-tab="charts">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                    </svg>
                    <span class="text-xs">Grafik</span>
                </button>
                
                <button class="nav-item flex flex-col items-center space-y-1 p-2 rounded-lg" data-tab="portfolio">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"></path>
                    </svg>
                    <span class="text-xs">Portf√∂y</span>
                </button>
            </div>
        </nav>

        <!-- Portfolio Modal -->
        <div id="portfolioModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-md border border-gray-200 dark:border-gray-700 max-h-[90vh] overflow-y-auto">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-bold">üíº Portf√∂y Takibi</h3>
                        <button id="closePortfolioModal" class="text-gray-500 hover:text-gray-700">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                    
                    <div class="space-y-4">
                        <div class="bg-gradient-to-r from-green-100 to-blue-100 dark:from-green-900 dark:to-blue-900 rounded-lg p-4">
                            <div class="text-center">
                                <div class="text-2xl font-bold" id="portfolioValue">$0.00</div>
                                <div class="text-sm text-gray-600 dark:text-gray-400">Toplam Deƒüer</div>
                                <div class="text-lg font-semibold mt-2" id="portfolioPnL">+$0.00 (0%)</div>
                            </div>
                        </div>
                        
                        <div class="space-y-3">
                            <h4 class="font-semibold">Pozisyonlar</h4>
                            <div id="portfolioPositions" class="space-y-2">
                                <!-- Portfolio positions will be shown here -->
                            </div>
                            
                            <button id="addPositionBtn" class="w-full py-2 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg text-gray-500 hover:border-primary hover:text-primary transition-colors">
                                + Pozisyon Ekle
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Notification Toast Enhanced -->
        <div id="notificationToast" class="fixed top-4 right-4 transform translate-x-full transition-transform duration-300 z-50">
            <div class="bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg p-4 min-w-80 max-w-sm">
                <div class="flex items-start">
                    <div id="toastIcon" class="flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center mr-3">
                        <span class="text-white font-bold text-sm"></span>
                    </div>
                    <div class="flex-1 min-w-0">
                        <div id="toastTitle" class="font-semibold"></div>
                        <div id="toastMessage" class="text-sm text-gray-600 dark:text-gray-400 break-words"></div>
                        <div id="toastTime" class="text-xs text-gray-400 mt-1"></div>
                    </div>
                    <button id="dismissToast" class="flex-shrink-0 ml-2 text-gray-400 hover:text-gray-600">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        <!-- Pull to Refresh Indicator -->
        <div id="pullToRefresh" class="hidden fixed top-16 left-1/2 transform -translate-x-1/2 bg-primary text-white px-4 py-2 rounded-full text-sm z-40 animate-bounce">
            ‚¨áÔ∏è Yenilemek i√ßin √ßekin
        </div>
    </div>

    <script>
        // Enhanced Theme Management
        function initializeTheme() {
            const savedTheme = localStorage.getItem('cryptoSignalsTheme');
            if (savedTheme) {
                document.documentElement.classList.toggle('dark', savedTheme === 'dark');
            } else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                document.documentElement.classList.add('dark');
            }
            
            window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
                if (!localStorage.getItem('cryptoSignalsTheme')) {
                    document.documentElement.classList.toggle('dark', event.matches);
                }
            });
        }

        function toggleTheme() {
            const isDark = document.documentElement.classList.contains('dark');
            document.documentElement.classList.toggle('dark', !isDark);
            localStorage.setItem('cryptoSignalsTheme', !isDark ? 'dark' : 'light');
        }

        // Enhanced Audio System with more sounds
        class EnhancedAudioSystem {
            constructor() {
                this.audioContext = null;
                this.soundEnabled = true;
                this.sounds = {
                    buy: { frequency: 800, duration: 0.3 },
                    sell: { frequency: 400, duration: 0.3 },
                    alert: { frequency: 1000, duration: 0.1, repeat: 3 },
                    notification: { frequency: 600, duration: 0.2 }
                };
                this.initAudio();
            }

            async initAudio() {
                try {
                    this.audioContext = new (window.AudioContext || window.webkitAudioContext)();
                } catch (e) {
                    console.log('Web Audio API not supported');
                }
            }

            playSignalSound(type = 'buy') {
                if (!this.soundEnabled || !this.audioContext) return;

                const sound = this.sounds[type] || this.sounds.notification;
                const repeat = sound.repeat || 1;

                for (let i = 0; i < repeat; i++) {
                    setTimeout(() => {
                        this.generateTone(sound.frequency, sound.duration);
                    }, i * (sound.duration * 1000 + 100));
                }
            }

            generateTone(frequency, duration) {
                const oscillator = this.audioContext.createOscillator();
                const gainNode = this.audioContext.createGain();

                oscillator.connect(gainNode);
                gainNode.connect(this.audioContext.destination);

                oscillator.frequency.setValueAtTime(frequency, this.audioContext.currentTime);
                oscillator.type = 'sine';
                
                gainNode.gain.setValueAtTime(0, this.audioContext.currentTime);
                gainNode.gain.linearRampToValueAtTime(0.3, this.audioContext.currentTime + 0.01);
                gainNode.gain.exponentialRampToValueAtTime(0.01, this.audioContext.currentTime + duration);

                oscillator.start(this.audioContext.currentTime);
                oscillator.stop(this.audioContext.currentTime + duration);
            }

            toggleSound() {
                this.soundEnabled = !this.soundEnabled;
                return this.soundEnabled;
            }
        }

        // Enhanced Real-time Price Chart
        class AdvancedRealTimePriceChart {
            constructor() {
                this.currentSymbol = 'btcusdt';
                this.currentInterval = '3m';
                this.chart = null;
                this.ws = null;
                this.priceData = [];
                this.timeLabels = [];
                this.maxDataPoints = 100;
                this.lastPrice = 0;
                
                this.initChart();
                this.bindEvents();
                this.connectWebSocket();
            }

            initChart() {
                const ctx = document.getElementById('priceChart').getContext('2d');
                const isDark = document.documentElement.classList.contains('dark');
                
                this.chart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: [],
                        datasets: [
                            {
                                label: 'Price',
                                data: [],
                                borderColor: '#5D5CDE',
                                backgroundColor: 'rgba(93, 92, 222, 0.1)',
                                borderWidth: 2,
                                fill: true,
                                tension: 0.4,
                                pointRadius: 0,
                                pointHoverRadius: 4
                            },
                            {
                                label: 'EMA 8',
                                data: [],
                                borderColor: '#10B981',
                                backgroundColor: 'transparent',
                                borderWidth: 1,
                                pointRadius: 0,
                                tension: 0.4
                            },
                            {
                                label: 'EMA 55',
                                data: [],
                                borderColor: '#EF4444',
                                backgroundColor: 'transparent',
                                borderWidth: 1,
                                pointRadius: 0,
                                tension: 0.4
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        interaction: {
                            intersect: false,
                            mode: 'index'
                        },
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top',
                                labels: {
                                    color: isDark ? '#ffffff' : '#000000',
                                    usePointStyle: true,
                                    padding: 20
                                }
                            },
                            tooltip: {
                                backgroundColor: isDark ? '#1f2937' : '#ffffff',
                                titleColor: isDark ? '#ffffff' : '#000000',
                                bodyColor: isDark ? '#ffffff' : '#000000',
                                borderColor: isDark ? '#374151' : '#e5e7eb',
                                borderWidth: 1
                            }
                        },
                        scales: {
                            x: {
                                display: true,
                                grid: {
                                    color: isDark ? 'rgba(107, 114, 128, 0.1)' : 'rgba(107, 114, 128, 0.1)'
                                },
                                ticks: {
                                    color: isDark ? '#9ca3af' : '#6b7280',
                                    maxTicksLimit: 8
                                }
                            },
                            y: {
                                display: true,
                                position: 'right',
                                grid: {
                                    color: isDark ? 'rgba(107, 114, 128, 0.1)' : 'rgba(107, 114, 128, 0.1)'
                                },
                                ticks: {
                                    color: isDark ? '#9ca3af' : '#6b7280',
                                    callback: function(value) {
                                        return '$' + value.toLocaleString();
                                    }
                                }
                            }
                        },
                        animation: {
                            duration: 0 // Disable animation for real-time updates
                        }
                    }
                });
            }

            bindEvents() {
                document.getElementById('chartSymbol').addEventListener('change', (e) => {
                    this.currentSymbol = e.target.value;
                    this.reconnect();
                });

                document.getElementById('chartInterval').addEventListener('change', (e) => {
                    this.currentInterval = e.target.value;
                    this.reconnect();
                });

                document.getElementById('refreshChart').addEventListener('click', () => {
                    this.reconnect();
                });
                
                // Chart type switcher
                document.getElementById('chartType').addEventListener('change', (e) => {
                    this.switchChartType(e.target.value);
                });
            }

            connectWebSocket() {
                this.updateStatus('connecting');
                
                if (this.ws) {
                    this.ws.close();
                }

                const stream = `${this.currentSymbol}@kline_${this.currentInterval}`;
                this.ws = new WebSocket(`wss://stream.binance.com:9443/ws/${stream}`);

                this.ws.onopen = () => {
                    this.updateStatus('connected');
                    console.log(`Chart connected to ${this.currentSymbol.toUpperCase()}`);
                };

                this.ws.onmessage = (event) => {
                    const data = JSON.parse(event.data);
                    this.handleKlineData(data);
                };

                this.ws.onerror = () => {
                    this.updateStatus('error');
                };

                this.ws.onclose = () => {
                    this.updateStatus('disconnected');
                    setTimeout(() => this.connectWebSocket(), 5000);
                };
            }

            handleKlineData(data) {
                if (!data.k) return;

                const kline = data.k;
                const price = parseFloat(kline.c);
                const time = new Date(kline.t).toLocaleTimeString('tr-TR', { 
                    hour: '2-digit', 
                    minute: '2-digit' 
                });

                // Update price change
                const priceChange = this.lastPrice > 0 ? ((price - this.lastPrice) / this.lastPrice) * 100 : 0;
                this.lastPrice = price;

                // Add new data point
                this.priceData.push(price);
                this.timeLabels.push(time);

                // Calculate simple EMAs for display
                const ema8 = this.calculateSimpleEMA(this.priceData, 8);
                const ema55 = this.calculateSimpleEMA(this.priceData, 55);

                // Remove old data points
                if (this.priceData.length > this.maxDataPoints) {
                    this.priceData.shift();
                    this.timeLabels.shift();
                }

                // Update chart
                this.chart.data.labels = this.timeLabels;
                this.chart.data.datasets[0].data = this.priceData;
                this.chart.data.datasets[1].data = this.priceData.map(() => ema8);
                this.chart.data.datasets[2].data = this.priceData.map(() => ema55);
                
                // Update label with current price and change
                const changeColor = priceChange >= 0 ? '#10B981' : '#EF4444';
                const changeSymbol = priceChange >= 0 ? '+' : '';
                this.chart.data.datasets[0].label = `${this.currentSymbol.toUpperCase()} - $${price.toLocaleString()} (${changeSymbol}${priceChange.toFixed(2)}%)`;
                this.chart.data.datasets[0].borderColor = changeColor;
                
                this.chart.update('none');
            }

            calculateSimpleEMA(data, period) {
                if (data.length < period) return data[data.length - 1] || 0;
                
                const multiplier = 2 / (period + 1);
                let ema = data[0];

                for (let i = 1; i < data.length; i++) {
                    ema = (data[i] * multiplier) + (ema * (1 - multiplier));
                }

                return ema;
            }

            updateStatus(status) {
                const statusEl = document.getElementById('chartStatus');
                if (!statusEl) return;

                const statusConfig = {
                    connecting: { text: 'CONNECTING', class: 'bg-yellow-100 dark:bg-yellow-900 text-yellow-600' },
                    connected: { text: 'LIVE', class: 'bg-green-100 dark:bg-green-900 text-green-600' },
                    error: { text: 'ERROR', class: 'bg-red-100 dark:bg-red-900 text-red-600' },
                    disconnected: { text: 'OFFLINE', class: 'bg-gray-100 dark:bg-gray-900 text-gray-600' }
                };

                const config = statusConfig[status];
                statusEl.textContent = config.text;
                statusEl.className = `ml-2 px-2 py-1 text-xs rounded-full ${config.class}`;
            }

            updateTheme() {
                const isDark = document.documentElement.classList.contains('dark');
                
                this.chart.options.plugins.legend.labels.color = isDark ? '#ffffff' : '#000000';
                this.chart.options.plugins.tooltip.backgroundColor = isDark ? '#1f2937' : '#ffffff';
                this.chart.options.plugins.tooltip.titleColor = isDark ? '#ffffff' : '#000000';
                this.chart.options.plugins.tooltip.bodyColor = isDark ? '#ffffff' : '#000000';
                this.chart.options.plugins.tooltip.borderColor = isDark ? '#374151' : '#e5e7eb';
                
                this.chart.options.scales.x.ticks.color = isDark ? '#9ca3af' : '#6b7280';
                this.chart.options.scales.y.ticks.color = isDark ? '#9ca3af' : '#6b7280';
                
                this.chart.update();
                
                // Update TradingView widget if active
                if (this.tradingViewWidget && document.getElementById('chartType').value === 'tradingview') {
                    this.loadTradingViewWidget();
                }
            }

            switchChartType(type) {
                const customContainer = document.getElementById('customChartContainer');
                const tradingViewContainer = document.getElementById('tradingViewContainer');
                
                if (type === 'tradingview') {
                    customContainer.style.display = 'none';
                    tradingViewContainer.style.display = 'block';
                    this.loadTradingViewWidget();
                } else {
                    customContainer.style.display = 'block';
                    tradingViewContainer.style.display = 'none';
                    this.reconnect();
                }
            }

            loadTradingViewWidget() {
                const container = document.getElementById('tradingview_widget');
                const isDark = document.documentElement.classList.contains('dark');
                
                // Clear existing widget
                container.innerHTML = '';
                
                // Create TradingView widget script
                const script = document.createElement('script');
                script.type = 'text/javascript';
                script.src = 'https://s3.tradingview.com/external-embedding/embed-widget-advanced-chart.js';
                script.async = true;
                
                // Convert symbol format for TradingView
                const tvSymbol = this.convertSymbolForTradingView(this.currentSymbol);
                
                // Widget configuration
                const config = {
                    autosize: true,
                    symbol: tvSymbol,
                    interval: this.convertIntervalForTradingView(this.currentInterval),
                    timezone: "Etc/UTC",
                    theme: isDark ? "dark" : "light",
                    style: "1",
                    locale: "en",
                    backgroundColor: isDark ? "#1f2937" : "#ffffff",
                    gridColor: isDark ? "rgba(255, 255, 255, 0.06)" : "rgba(46, 46, 46, 0.06)",
                    allow_symbol_change: true,
                    calendar: false,
                    details: false,
                    hide_side_toolbar: false,
                    hide_top_toolbar: false,
                    hide_legend: false,
                    hide_volume: false,
                    hotlist: false,
                    save_image: true,
                    withdateranges: false,
                    compareSymbols: [],
                    studies: [],
                    watchlist: []
                };
                
                script.innerHTML = JSON.stringify(config);
                container.appendChild(script);
            }

            convertSymbolForTradingView(symbol) {
                // Convert binance symbols to TradingView format
                const symbolMap = {
                    'btcusdt': 'BINANCE:BTCUSDT',
                    'ethusdt': 'BINANCE:ETHUSDT',
                    'adausdt': 'BINANCE:ADAUSDT',
                    'bnbusdt': 'BINANCE:BNBUSDT',
                    'solusdt': 'BINANCE:SOLUSDT',
                    'dogeusdt': 'BINANCE:DOGEUSDT',
                    'xrpusdt': 'BINANCE:XRPUSDT',
                    'avaxusdt': 'BINANCE:AVAXUSDT',
                    'dotusdt': 'BINANCE:DOTUSDT',
                    'maticusdt': 'BINANCE:MATICUSDT',
                    'linkusdt': 'BINANCE:LINKUSDT',
                    'ltcusdt': 'BINANCE:LTCUSDT'
                };
                
                return symbolMap[symbol.toLowerCase()] || `BINANCE:${symbol.toUpperCase()}`;
            }

            convertIntervalForTradingView(interval) {
                // Convert binance intervals to TradingView format
                const intervalMap = {
                    '1m': '1',
                    '3m': '3',
                    '5m': '5',
                    '15m': '15',
                    '30m': '30',
                    '1h': '60',
                    '4h': '240',
                    '1d': 'D'
                };
                
                return intervalMap[interval] || '5';
            }

            reconnect() {
                this.priceData = [];
                this.timeLabels = [];
                this.chart.data.labels = [];
                this.chart.data.datasets.forEach(dataset => dataset.data = []);
                this.chart.update();
                this.connectWebSocket();
            }

            disconnect() {
                if (this.ws) {
                    this.ws.close();
                    this.ws = null;
                }
            }
        }

        // Advanced Multi-Pair Trading Signals System
        class AdvancedMultiPairTradingSignals {
            constructor() {
                this.pairs = new Map();
                this.allSignals = [];
                this.alerts = [];
                this.portfolio = [];
                this.notificationsEnabled = false;
                this.soundEnabled = true;
                this.signalStats = { 
                    buy: 0, 
                    sell: 0, 
                    successful: 0, 
                    failed: 0, 
                    pending: 0,
                    totalPnL: 0
                };
                this.marketData = {};
                this.currentFilter = 'all';
                
                this.audioSystem = new EnhancedAudioSystem();
                
                this.bindEvents();
                this.loadStoredData();
                this.updateUI();
                this.startMarketDataUpdates();
                this.initPWA();
            }

            bindEvents() {
                // Existing event bindings
                document.getElementById('addPairBtn').addEventListener('click', () => this.addPair());
                document.getElementById('addCustomPairBtn').addEventListener('click', () => this.addCustomPair());
                document.getElementById('clearAllBtn').addEventListener('click', () => this.clearAllPairs());
                
                // Theme toggles
                document.getElementById('themeToggle').addEventListener('click', toggleTheme);
                document.getElementById('mobileThemeToggle').addEventListener('click', toggleTheme);
                
                // Sound toggles
                document.getElementById('soundToggle').addEventListener('click', () => this.toggleSound());
                document.getElementById('mobileSoundToggle').addEventListener('click', () => this.toggleSound());
                
                // Notification toggles
                document.getElementById('notificationBtn').addEventListener('click', () => this.enableNotifications());
                document.getElementById('mobileNotificationBtn').addEventListener('click', () => this.enableNotifications());
                
                // Portfolio buttons
                document.getElementById('portfolioBtn').addEventListener('click', () => this.openPortfolioModal());
                document.getElementById('mobilePortfolioBtn').addEventListener('click', () => this.openPortfolioModal());
                document.getElementById('closePortfolioModal').addEventListener('click', () => this.closePortfolioModal());
                
                // Mobile menu
                document.getElementById('mobileMenuBtn').addEventListener('click', () => this.toggleMobileMenu());
                
                // Quick add buttons
                document.querySelectorAll('.quick-add-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const symbol = e.target.dataset.symbol;
                        document.getElementById('symbolSelect').value = symbol;
                        this.addPair();
                    });
                });
                
                // Filter buttons
                document.querySelectorAll('.filter-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        this.currentFilter = e.target.dataset.filter;
                        this.updateFilterButtons();
                        this.filterPairs();
                    });
                });
                
                // Enhanced features
                document.getElementById('presetPairsBtn').addEventListener('click', () => this.addPresetPairs());
                document.getElementById('sortPairsBtn').addEventListener('click', () => this.sortPairs());
                document.getElementById('exportPairsBtn').addEventListener('click', () => this.exportData());
                document.getElementById('signalFilter').addEventListener('change', (e) => this.filterSignals(e.target.value));
                document.getElementById('clearHistoryBtn').addEventListener('click', () => this.clearSignalHistory());
                document.getElementById('refreshStats').addEventListener('click', () => this.refreshStatistics());
                
                // Price alerts
                document.getElementById('addAlertBtn').addEventListener('click', () => this.addPriceAlert());
                
                // Portfolio management
                document.getElementById('addPositionBtn').addEventListener('click', () => this.addPortfolioPosition());
                
                // Bottom navigation for mobile
                document.querySelectorAll('.nav-item').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        this.switchMobileTab(e.currentTarget.dataset.tab);
                    });
                });
                
                // Pull to refresh for mobile
                this.initPullToRefresh();
                
                // Toast dismiss
                document.getElementById('dismissToast').addEventListener('click', () => this.hideToast());
                
                // PWA install
                document.getElementById('installBtn').addEventListener('click', () => this.installPWA());
                document.getElementById('dismissBanner').addEventListener('click', () => this.dismissInstallBanner());
            }

            // Market Data Updates
            async startMarketDataUpdates() {
                this.updateMarketOverview();
                setInterval(() => this.updateMarketOverview(), 30000); // Update every 30 seconds
            }

            async updateMarketOverview() {
                try {
                    // Simulate market data - in real implementation, use actual API
                    const btcData = await this.fetchPriceData('BTCUSDT');
                    const ethData = await this.fetchPriceData('ETHUSDT');
                    
                    this.updateMarketCard('btc', btcData.price, btcData.change);
                    this.updateMarketCard('eth', ethData.price, ethData.change);
                    
                    // Update fear and greed index (simulated)
                    const fearGreed = Math.floor(Math.random() * 100);
                    this.updateFearGreedIndex(fearGreed);
                    
                    // Update signal accuracy
                    this.updateSignalAccuracy();
                    
                } catch (error) {
                    console.error('Market data update failed:', error);
                }
            }

            async fetchPriceData(symbol) {
                try {
                    const response = await fetch(`https://api.binance.com/api/v3/ticker/24hr?symbol=${symbol}`);
                    const data = await response.json();
                    
                    return {
                        price: parseFloat(data.lastPrice),
                        change: parseFloat(data.priceChangePercent)
                    };
                } catch (error) {
                    console.error(`Failed to fetch price for ${symbol}:`, error);
                    // Fallback to simulated data
                    const basePrice = symbol === 'BTCUSDT' ? 43000 : 2800;
                    const price = basePrice + (Math.random() - 0.5) * basePrice * 0.05;
                    const change = (Math.random() - 0.5) * 8;
                    
                    return { price, change };
                }
            }

            updateMarketCard(crypto, price, change) {
                const priceEl = document.getElementById(`${crypto}Price`);
                const changeEl = document.getElementById(`${crypto}Change`);
                const trendIconEl = document.getElementById(`${crypto}TrendIcon`);
                const sparklineEl = document.getElementById(`${crypto}Sparkline`);
                
                if (priceEl) {
                    priceEl.textContent = `$${price.toLocaleString()}`;
                    
                    // Add price animation
                    priceEl.classList.add('animate-pulse');
                    setTimeout(() => priceEl.classList.remove('animate-pulse'), 1000);
                }
                
                if (changeEl) {
                    changeEl.textContent = `${change >= 0 ? '+' : ''}${change.toFixed(2)}%`;
                    changeEl.className = `text-sm font-bold ${change >= 0 ? 'text-white' : 'text-red-200'}`;
                }
                
                // Update trend icon
                if (trendIconEl) {
                    if (change >= 0) {
                        trendIconEl.innerHTML = `
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
                        `;
                    } else {
                        trendIconEl.innerHTML = `
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 17h8m0 0v-8m0 8l-8-8-4 4-6-6"></path>
                        `;
                    }
                }
                
                // Simple sparkline effect
                if (sparklineEl) {
                    const height = Math.abs(change) * 2;
                    sparklineEl.style.background = `linear-gradient(to top, ${change >= 0 ? '#10B981' : '#EF4444'} ${height}%, transparent ${height}%)`;
                }
            }

            updateFearGreedIndex(value) {
                document.getElementById('fearGreedIndex').textContent = value;
                
                let label, className;
                if (value < 25) {
                    label = 'Extreme Fear';
                    className = 'text-red-600';
                } else if (value < 45) {
                    label = 'Fear';
                    className = 'text-orange-600';
                } else if (value < 55) {
                    label = 'Neutral';
                    className = 'text-white';
                } else if (value < 75) {
                    label = 'Greed';
                    className = 'text-green-200';
                } else {
                    label = 'Extreme Greed';
                    className = 'text-green-100';
                }
                
                const labelEl = document.getElementById('fearGreedLabel');
                labelEl.textContent = label;
                labelEl.className = `text-sm font-bold ${className}`;
                
                // Update progress bar
                const barEl = document.getElementById('fearGreedBar');
                if (barEl) {
                    barEl.style.width = `${value}%`;
                }
            }

            updateSignalAccuracy() {
                const total = this.signalStats.successful + this.signalStats.failed;
                const accuracy = total > 0 ? (this.signalStats.successful / total * 100) : 0;
                
                document.getElementById('signalAccuracy').textContent = `${accuracy.toFixed(1)}%`;
                document.getElementById('totalSignalsCount').textContent = `${total} signals`;
                
                // Update accuracy bar
                const accuracyBarEl = document.getElementById('accuracyBar');
                if (accuracyBarEl) {
                    accuracyBarEl.style.width = `${accuracy}%`;
                }
            }

            // Enhanced Pair Management
            addPair() {
                const symbol = document.getElementById('symbolSelect').value;
                const interval = document.getElementById('intervalSelect').value;
                const emaShort = parseInt(document.getElementById('emaShort').value);
                const emaLong = parseInt(document.getElementById('emaLong').value);

                if (!symbol) {
                    this.showToast('danger', 'Hata!', 'L√ºtfen bir sembol se√ßin');
                    return;
                }

                this.addPairToSystem(symbol, interval, emaShort, emaLong);
            }

            addCustomPair() {
                const customSymbol = document.getElementById('customSymbol').value.toLowerCase().trim();
                const interval = document.getElementById('intervalSelect').value;
                const emaShort = parseInt(document.getElementById('emaShort').value);
                const emaLong = parseInt(document.getElementById('emaLong').value);

                if (!customSymbol) {
                    this.showToast('danger', 'Hata!', 'L√ºtfen bir sembol girin');
                    return;
                }

                this.addPairToSystem(customSymbol, interval, emaShort, emaLong);
                document.getElementById('customSymbol').value = '';
            }

            addPresetPairs() {
                const presets = [
                    { symbol: 'btcusdt', interval: '5m', emaShort: 8, emaLong: 55 },
                    { symbol: 'ethusdt', interval: '5m', emaShort: 8, emaLong: 55 },
                    { symbol: 'solusdt', interval: '3m', emaShort: 12, emaLong: 26 }
                ];

                presets.forEach(preset => {
                    this.addPairToSystem(preset.symbol, preset.interval, preset.emaShort, preset.emaLong);
                });

                this.showToast('success', 'Preset Eklendi!', `${presets.length} pop√ºler √ßift eklendi`);
            }

            addPairToSystem(symbol, interval, emaShort, emaLong) {
                const pairKey = `${symbol}_${interval}_${emaShort}_${emaLong}`;
                
                if (this.pairs.has(pairKey)) {
                    this.showToast('warning', 'Uyarƒ±!', 'Bu √ßift zaten eklendi');
                    return;
                }

                const pairTracker = new EnhancedPairTracker(symbol, interval, emaShort, emaLong, this);
                this.pairs.set(pairKey, pairTracker);
                
                this.createPairCard(pairKey, pairTracker);
                this.updateUI();
                this.saveData();
                
                this.showToast('success', 'Ba≈üarƒ±lƒ±!', `${symbol.toUpperCase()} √ßifti eklendi`);
            }

            createPairCard(pairKey, pairTracker) {
                const activePairsEl = document.getElementById('activePairs');
                const card = document.createElement('div');
                card.className = 'pair-card mobile-card bg-gray-50 dark:bg-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600 relative overflow-hidden';
                card.id = `pair_${pairKey}`;

                card.innerHTML = `
                    <div class="flex justify-between items-start mb-3">
                        <div class="flex-1">
                            <h3 class="font-bold text-lg">${pairTracker.symbol.toUpperCase()}</h3>
                            <p class="text-sm text-gray-600 dark:text-gray-400">${pairTracker.interval} ‚Ä¢ EMA ${pairTracker.emaShort}/${pairTracker.emaLong}</p>
                            <div class="flex items-center space-x-2 mt-1">
                                <span class="text-xs px-2 py-1 bg-blue-100 dark:bg-blue-900 text-blue-600 rounded-full" id="volume_${pairKey}">Vol: 0</span>
                                <span class="text-xs px-2 py-1 bg-purple-100 dark:bg-purple-900 text-purple-600 rounded-full" id="signals_count_${pairKey}">0 signals</span>
                            </div>
                        </div>
                        <div class="flex space-x-1">
                            <button onclick="multiPairApp.togglePairAlerts('${pairKey}')" class="p-1 text-yellow-600 hover:text-yellow-700" title="Alarmlar">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-5 5v-5z"></path>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4"></path>
                                </svg>
                            </button>
                            <button onclick="multiPairApp.removePair('${pairKey}')" class="p-1 text-red-600 hover:text-red-700" title="Kaldƒ±r">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                    
                    <div class="space-y-2">
                        <div class="flex justify-between text-sm">
                            <span>Fiyat:</span>
                            <span class="font-mono font-bold" id="price_${pairKey}">$0.00</span>
                        </div>
                        <div class="flex justify-between text-sm">
                            <span>24h Deƒüi≈üim:</span>
                            <span class="font-mono" id="change_${pairKey}">0%</span>
                        </div>
                        <div class="flex justify-between text-sm">
                            <span class="text-green-600">EMA ${pairTracker.emaShort}:</span>
                            <span class="font-mono text-green-600" id="ema_short_${pairKey}">$0.00</span>
                        </div>
                        <div class="flex justify-between text-sm">
                            <span class="text-red-600">EMA ${pairTracker.emaLong}:</span>
                            <span class="font-mono text-red-600" id="ema_long_${pairKey}">$0.00</span>
                        </div>
                        <div class="flex justify-between text-sm">
                            <span>Durum:</span>
                            <span class="connection-status text-xs" id="status_${pairKey}">
                                <span class="w-2 h-2 bg-yellow-500 rounded-full inline-block"></span>
                                Baƒülanƒ±yor...
                            </span>
                        </div>
                        <div class="text-center pt-2 border-t border-gray-200 dark:border-gray-600" id="signal_${pairKey}">
                            <span class="text-xs text-gray-500">Sinyal bekleniyor...</span>
                        </div>
                    </div>
                    
                    <!-- Performance indicator -->
                    <div class="absolute top-2 right-2 w-3 h-3 rounded-full performance-neutral" id="performance_${pairKey}" title="Performance"></div>
                `;

                activePairsEl.appendChild(card);
            }

            // Enhanced Signal Management
            addSignal(signal) {
                signal.id = Date.now() + Math.random();
                signal.status = 'pending';
                signal.timestamp = new Date().toLocaleString('tr-TR');
                
                this.allSignals.unshift(signal);
                
                if (this.allSignals.length > 200) {
                    this.allSignals = this.allSignals.slice(0, 200);
                }

                this.signalStats[signal.type.toLowerCase()]++;
                this.signalStats.pending++;
                
                // Simulate signal outcome after 5 minutes (for demo)
                setTimeout(() => this.updateSignalOutcome(signal.id), 5 * 60 * 1000);
                
                this.updateCombinedSignalsUI();
                this.showNotification(signal);
                this.playSignalSound(signal.type);
                this.saveData();
                
                this.showToast(
                    signal.type === 'BUY' ? 'success' : 'danger',
                    `${signal.type} Sinyali!`,
                    `${signal.symbol} - $${signal.price.toLocaleString()}`
                );
            }

            updateSignalOutcome(signalId) {
                const signal = this.allSignals.find(s => s.id === signalId);
                if (!signal || signal.status !== 'pending') return;
                
                // Simulate outcome (70% success rate)
                const isSuccessful = Math.random() > 0.3;
                const pnl = isSuccessful ? 
                    (signal.price * 0.02 * (Math.random() + 0.5)) : 
                    -(signal.price * 0.015 * (Math.random() + 0.5));
                
                signal.status = isSuccessful ? 'successful' : 'failed';
                signal.pnl = pnl;
                signal.outcome_time = new Date().toLocaleString('tr-TR');
                
                this.signalStats.pending--;
                this.signalStats[signal.status]++;
                this.signalStats.totalPnL += pnl;
                
                this.updateCombinedSignalsUI();
                this.saveData();
            }

            // Portfolio Management
            openPortfolioModal() {
                document.getElementById('portfolioModal').classList.remove('hidden');
                this.updatePortfolioDisplay();
            }

            closePortfolioModal() {
                document.getElementById('portfolioModal').classList.add('hidden');
            }

            addPortfolioPosition() {
                const symbol = prompt('Sembol girin (√∂rn: BTCUSDT):');
                const quantity = parseFloat(prompt('Miktar girin:'));
                const price = parseFloat(prompt('Giri≈ü fiyatƒ± girin:'));
                
                if (symbol && quantity && price) {
                    this.portfolio.push({
                        id: Date.now(),
                        symbol: symbol.toUpperCase(),
                        quantity,
                        entryPrice: price,
                        currentPrice: price,
                        addedAt: new Date().toISOString()
                    });
                    
                    this.updatePortfolioDisplay();
                    this.saveData();
                    this.showToast('success', 'Pozisyon Eklendi!', `${symbol.toUpperCase()} portf√∂ye eklendi`);
                }
            }

            updatePortfolioDisplay() {
                const positionsEl = document.getElementById('portfolioPositions');
                const valueEl = document.getElementById('portfolioValue');
                const pnlEl = document.getElementById('portfolioPnL');
                
                let totalValue = 0;
                let totalPnL = 0;
                
                positionsEl.innerHTML = '';
                
                this.portfolio.forEach(position => {
                    const value = position.quantity * position.currentPrice;
                    const pnl = (position.currentPrice - position.entryPrice) * position.quantity;
                    const pnlPercent = (pnl / (position.entryPrice * position.quantity)) * 100;
                    
                    totalValue += value;
                    totalPnL += pnl;
                    
                    const positionEl = document.createElement('div');
                    positionEl.className = 'bg-gray-50 dark:bg-gray-700 rounded-lg p-3';
                    positionEl.innerHTML = `
                        <div class="flex justify-between items-start">
                            <div>
                                <div class="font-semibold">${position.symbol}</div>
                                <div class="text-sm text-gray-600 dark:text-gray-400">${position.quantity} @ $${position.entryPrice.toLocaleString()}</div>
                            </div>
                            <div class="text-right">
                                <div class="font-semibold">$${value.toLocaleString()}</div>
                                <div class="text-sm ${pnl >= 0 ? 'text-green-600' : 'text-red-600'}">
                                    ${pnl >= 0 ? '+' : ''}$${pnl.toFixed(2)} (${pnl >= 0 ? '+' : ''}${pnlPercent.toFixed(1)}%)
                                </div>
                            </div>
                        </div>
                    `;
                    
                    positionsEl.appendChild(positionEl);
                });
                
                valueEl.textContent = `$${totalValue.toLocaleString()}`;
                const totalPnLPercent = totalValue > 0 ? (totalPnL / (totalValue - totalPnL)) * 100 : 0;
                pnlEl.textContent = `${totalPnL >= 0 ? '+' : ''}$${totalPnL.toFixed(2)} (${totalPnL >= 0 ? '+' : ''}${totalPnLPercent.toFixed(1)}%)`;
                pnlEl.className = `text-lg font-semibold ${totalPnL >= 0 ? 'text-green-600' : 'text-red-600'}`;
            }

            // Price Alerts
            addPriceAlert() {
                const symbol = document.getElementById('alertSymbol').value;
                const price = parseFloat(document.getElementById('alertPrice').value);
                
                if (!symbol || !price) {
                    this.showToast('danger', 'Hata!', 'Sembol ve fiyat gerekli');
                    return;
                }
                
                this.alerts.push({
                    id: Date.now(),
                    symbol: symbol.toUpperCase(),
                    targetPrice: price,
                    createdAt: new Date().toISOString()
                });
                
                this.updateAlertsDisplay();
                this.saveData();
                document.getElementById('alertPrice').value = '';
                
                this.showToast('success', 'Alarm Eklendi!', `${symbol.toUpperCase()} - $${price.toLocaleString()}`);
            }

            updateAlertsDisplay() {
                const alertsEl = document.getElementById('activeAlerts');
                alertsEl.innerHTML = '';
                
                this.alerts.forEach(alert => {
                    const alertEl = document.createElement('div');
                    alertEl.className = 'flex justify-between items-center p-2 bg-yellow-50 dark:bg-yellow-900/20 rounded text-sm';
                    alertEl.innerHTML = `
                        <div>
                            <span class="font-semibold">${alert.symbol}</span>
                            <span class="text-gray-600 dark:text-gray-400 ml-2">$${alert.targetPrice.toLocaleString()}</span>
                        </div>
                        <button onclick="multiPairApp.removeAlert(${alert.id})" class="text-red-600 hover:text-red-700">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    `;
                    alertsEl.appendChild(alertEl);
                });
            }

            removeAlert(alertId) {
                this.alerts = this.alerts.filter(alert => alert.id !== alertId);
                this.updateAlertsDisplay();
                this.saveData();
            }

            // Enhanced UI Management
            toggleMobileMenu() {
                const menu = document.getElementById('mobileMenu');
                menu.classList.toggle('hidden');
            }

            switchMobileTab(tab) {
                // Update active nav item
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.classList.remove('text-primary', 'bg-primary/10');
                });
                document.querySelector(`[data-tab="${tab}"]`).classList.add('text-primary', 'bg-primary/10');
                
                // Show appropriate content (simplified for demo)
                switch(tab) {
                    case 'charts':
                        document.querySelector('#customChartContainer').scrollIntoView({ behavior: 'smooth' });
                        break;
                    case 'signals':
                        document.querySelector('#combinedSignalHistory').scrollIntoView({ behavior: 'smooth' });
                        break;
                    case 'portfolio':
                        this.openPortfolioModal();
                        break;
                    default:
                        document.querySelector('#activePairs').scrollIntoView({ behavior: 'smooth' });
                }
            }

            filterPairs() {
                const pairs = document.querySelectorAll('.pair-card');
                pairs.forEach(pair => {
                    const pairKey = pair.id.replace('pair_', '');
                    const pairTracker = this.pairs.get(pairKey);
                    
                    let show = true;
                    switch(this.currentFilter) {
                        case 'profitable':
                            // Show only profitable pairs (simplified logic)
                            show = pair.querySelector('.performance-positive') !== null;
                            break;
                        case 'signals':
                            // Show pairs with recent signals
                            show = pair.querySelector('[id*="signal_"]').innerHTML.includes('BUY') || 
                                   pair.querySelector('[id*="signal_"]').innerHTML.includes('SELL');
                            break;
                        case 'alerts':
                            // Show pairs with active alerts
                            show = this.alerts.some(alert => alert.symbol.toLowerCase().includes(pairKey.split('_')[0]));
                            break;
                        default:
                            show = true;
                    }
                    
                    pair.style.display = show ? 'block' : 'none';
                });
            }

            updateFilterButtons() {
                document.querySelectorAll('.filter-btn').forEach(btn => {
                    btn.classList.remove('active', 'bg-primary', 'text-white');
                    btn.classList.add('bg-gray-200', 'dark:bg-gray-700');
                    
                    if (btn.dataset.filter === this.currentFilter) {
                        btn.classList.remove('bg-gray-200', 'dark:bg-gray-700');
                        btn.classList.add('active', 'bg-primary', 'text-white');
                    }
                });
            }

            // Data Management
            saveData() {
                const data = {
                    pairs: Array.from(this.pairs.entries()).map(([key, tracker]) => ({
                        key,
                        symbol: tracker.symbol,
                        interval: tracker.interval,
                        emaShort: tracker.emaShort,
                        emaLong: tracker.emaLong
                    })),
                    signals: this.allSignals.slice(0, 50), // Save only recent signals
                    alerts: this.alerts,
                    portfolio: this.portfolio,
                    signalStats: this.signalStats,
                    notificationsEnabled: this.notificationsEnabled,
                    soundEnabled: this.soundEnabled
                };
                
                try {
                    localStorage.setItem('cryptoSignalsData', JSON.stringify(data));
                } catch (error) {
                    console.error('Failed to save data:', error);
                }
            }

            loadStoredData() {
                try {
                    const stored = localStorage.getItem('cryptoSignalsData');
                    if (stored) {
                        const data = JSON.parse(stored);
                        
                        this.allSignals = data.signals || [];
                        this.alerts = data.alerts || [];
                        this.portfolio = data.portfolio || [];
                        this.signalStats = { ...this.signalStats, ...(data.signalStats || {}) };
                        this.notificationsEnabled = data.notificationsEnabled || false;
                        this.soundEnabled = data.soundEnabled !== false;
                        
                        // Restore pairs
                        if (data.pairs) {
                            data.pairs.forEach(pairData => {
                                this.addPairToSystem(pairData.symbol, pairData.interval, pairData.emaShort, pairData.emaLong);
                            });
                        }
                        
                        this.updateAlertsDisplay();
                        this.updateNotificationButton();
                        this.updateSoundButton();
                    }
                } catch (error) {
                    console.error('Failed to load stored data:', error);
                }
            }

            exportData() {
                const data = {
                    exportedAt: new Date().toISOString(),
                    pairs: Array.from(this.pairs.keys()),
                    signalStats: this.signalStats,
                    recentSignals: this.allSignals.slice(0, 10),
                    alerts: this.alerts,
                    portfolio: this.portfolio
                };
                
                const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `crypto-signals-${new Date().toISOString().split('T')[0]}.json`;
                a.click();
                URL.revokeObjectURL(url);
                
                this.showToast('success', 'Export Tamamlandƒ±!', 'Veriler ba≈üarƒ±yla indirildi');
            }

            // PWA Features
            initPWA() {
                // Check if PWA can be installed
                window.addEventListener('beforeinstallprompt', (e) => {
                    e.preventDefault();
                    this.deferredPrompt = e;
                    this.showInstallBanner();
                });
            }

            showInstallBanner() {
                document.getElementById('installBanner').classList.remove('hidden');
                setTimeout(() => {
                    document.getElementById('installBanner').classList.add('animate-slide-down');
                }, 100);
            }

            dismissInstallBanner() {
                document.getElementById('installBanner').classList.add('hidden');
                localStorage.setItem('installBannerDismissed', 'true');
            }

            async installPWA() {
                if (this.deferredPrompt) {
                    this.deferredPrompt.prompt();
                    const { outcome } = await this.deferredPrompt.userChoice;
                    if (outcome === 'accepted') {
                        this.showToast('success', 'Uygulama Y√ºklendi!', 'Ana ekranƒ±nƒ±zdan eri≈üebilirsiniz');
                    }
                    this.deferredPrompt = null;
                    this.dismissInstallBanner();
                }
            }

            // Pull to Refresh
            initPullToRefresh() {
                let startY = 0;
                let currentY = 0;
                let isPulling = false;
                
                document.addEventListener('touchstart', (e) => {
                    if (window.scrollY === 0) {
                        startY = e.touches[0].clientY;
                        isPulling = true;
                    }
                });
                
                document.addEventListener('touchmove', (e) => {
                    if (isPulling && window.scrollY === 0) {
                        currentY = e.touches[0].clientY;
                        const pullDistance = currentY - startY;
                        
                        if (pullDistance > 50) {
                            document.getElementById('pullToRefresh').classList.remove('hidden');
                        }
                    }
                });
                
                document.addEventListener('touchend', () => {
                    if (isPulling && currentY - startY > 100) {
                        this.refreshAllData();
                    }
                    
                    document.getElementById('pullToRefresh').classList.add('hidden');
                    isPulling = false;
                    startY = 0;
                    currentY = 0;
                });
            }

            refreshAllData() {
                this.showToast('success', 'Yenileniyor...', 'T√ºm veriler g√ºncelleniyor');
                
                // Refresh market data
                this.updateMarketOverview();
                
                // Refresh chart
                if (window.realTimePriceChart) {
                    window.realTimePriceChart.reconnect();
                }
                
                // Refresh pairs
                this.pairs.forEach(tracker => tracker.reconnect && tracker.reconnect());
            }

            // Enhanced Toast System
            showToast(type, title, message) {
                const toast = document.getElementById('notificationToast');
                const icon = document.getElementById('toastIcon');
                const titleEl = document.getElementById('toastTitle');
                const messageEl = document.getElementById('toastMessage');
                const timeEl = document.getElementById('toastTime');

                const iconConfig = {
                    success: { icon: '‚úì', class: 'notification-success' },
                    danger: { icon: '!', class: 'notification-danger' },
                    warning: { icon: '‚ö†', class: 'notification-warning' }
                };

                const config = iconConfig[type] || iconConfig.success;
                icon.className = `flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center mr-3 ${config.class}`;
                icon.querySelector('span').textContent = config.icon;
                titleEl.textContent = title;
                messageEl.textContent = message;
                timeEl.textContent = new Date().toLocaleTimeString('tr-TR', { 
                    hour: '2-digit', 
                    minute: '2-digit' 
                });

                toast.classList.remove('translate-x-full');
                
                this.toastTimeout = setTimeout(() => {
                    this.hideToast();
                }, 5000);
            }

            hideToast() {
                const toast = document.getElementById('notificationToast');
                toast.classList.add('translate-x-full');
                if (this.toastTimeout) {
                    clearTimeout(this.toastTimeout);
                }
            }

            // Enhanced features implementation
            sortPairs() {
                const activePairsEl = document.getElementById('activePairs');
                const pairs = Array.from(activePairsEl.children);
                
                pairs.sort((a, b) => {
                    // Sort by symbol name
                    const aSymbol = a.querySelector('h3').textContent;
                    const bSymbol = b.querySelector('h3').textContent;
                    return aSymbol.localeCompare(bSymbol);
                });
                
                pairs.forEach(pair => activePairsEl.appendChild(pair));
                this.showToast('success', 'Sƒ±ralandƒ±!', '√áiftler alfabetik olarak sƒ±ralandƒ±');
            }

            filterSignals(filter) {
                const signalItems = document.querySelectorAll('#combinedSignalHistory > div');
                
                signalItems.forEach(item => {
                    let show = true;
                    
                    switch(filter) {
                        case 'buy':
                            show = item.innerHTML.includes('BUY');
                            break;
                        case 'sell':
                            show = item.innerHTML.includes('SELL');
                            break;
                        case 'today':
                            const today = new Date().toLocaleDateString('tr-TR');
                            show = item.innerHTML.includes(today);
                            break;
                        default:
                            show = true;
                    }
                    
                    item.style.display = show ? 'block' : 'none';
                });
            }

            clearSignalHistory() {
                if (confirm('Sinyal ge√ßmi≈üini temizlemek istediƒüinizden emin misiniz?')) {
                    this.allSignals = [];
                    this.signalStats = { buy: 0, sell: 0, successful: 0, failed: 0, pending: 0, totalPnL: 0 };
                    this.updateCombinedSignalsUI();
                    this.saveData();
                    this.showToast('success', 'Temizlendi!', 'Sinyal ge√ßmi≈üi silindi');
                }
            }

            refreshStatistics() {
                this.updateSignalAccuracy();
                this.updateMarketOverview();
                this.showToast('success', 'G√ºncellendi!', 'ƒ∞statistikler yenilendi');
            }

            // Rest of the methods remain similar but with mobile enhancements...
            // (continuing with existing methods from original code with mobile improvements)

            removePair(pairKey) {
                const pairTracker = this.pairs.get(pairKey);
                if (pairTracker) {
                    pairTracker.disconnect();
                    this.pairs.delete(pairKey);
                    
                    const cardEl = document.getElementById(`pair_${pairKey}`);
                    if (cardEl) {
                        cardEl.style.animation = 'slideUp 0.3s ease-out reverse';
                        setTimeout(() => cardEl.remove(), 300);
                    }
                    
                    this.updateUI();
                    this.saveData();
                    this.showToast('success', 'Silindi!', `√áift kaldƒ±rƒ±ldƒ±`);
                }
            }

            clearAllPairs() {
                if (this.pairs.size === 0) return;

                if (confirm('T√ºm √ßiftleri kaldƒ±rmak istediƒüinizden emin misiniz?')) {
                    this.pairs.forEach(pairTracker => pairTracker.disconnect());
                    this.pairs.clear();
                    
                    document.getElementById('activePairs').innerHTML = '';
                    this.updateUI();
                    this.saveData();
                    this.showToast('success', 'Temizlendi!', 'T√ºm √ßiftler kaldƒ±rƒ±ldƒ±');
                }
            }

            toggleSound() {
                this.soundEnabled = this.audioSystem.toggleSound();
                this.updateSoundButton();
                this.saveData();
                this.showToast('success', 'Ses Ayarƒ±', this.soundEnabled ? 'Ses a√ßƒ±ldƒ±' : 'Ses kapatƒ±ldƒ±');
            }

            updateSoundButton() {
                const updateButton = (button, icon) => {
                    if (!button || !icon) return;
                    
                    if (this.soundEnabled) {
                        icon.innerHTML = `
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 14.142M5 7h4l5-5v16l-5-5H5a2 2 0 01-2-2V9a2 2 0 012-2z"></path>
                        `;
                        button.title = 'Ses A√ßƒ±k';
                        button.classList.remove('bg-red-100', 'dark:bg-red-900');
                        button.classList.add('bg-gray-100', 'dark:bg-gray-700');
                    } else {
                        icon.innerHTML = `
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.586 15H4a2 2 0 01-2-2V9a2 2 0 012-2h1.586l4.707-4.707C10.923 1.663 12 2.109 12 3v18c0 .891-1.077 1.337-1.707.707L5.586 15z" clip-rule="evenodd"></path>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2"></path>
                        `;
                        button.title = 'Ses Kapalƒ±';
                        button.classList.remove('bg-gray-100', 'dark:bg-gray-700');
                        button.classList.add('bg-red-100', 'dark:bg-red-900');
                    }
                };
                
                updateButton(document.getElementById('soundToggle'), document.getElementById('soundIcon'));
                updateButton(document.getElementById('mobileSoundToggle'), document.querySelector('#mobileSoundToggle svg'));
            }

            playSignalSound(type) {
                if (this.soundEnabled) {
                    this.audioSystem.playSignalSound(type.toLowerCase());
                    
                    // Visual feedback
                    [document.getElementById('soundToggle'), document.getElementById('mobileSoundToggle')].forEach(button => {
                        if (button) {
                            button.classList.add('sound-wave');
                            setTimeout(() => button.classList.remove('sound-wave'), 800);
                        }
                    });
                }
            }

            async enableNotifications() {
                if ('Notification' in window) {
                    if (this.notificationsEnabled) {
                        this.notificationsEnabled = false;
                        this.updateNotificationButton();
                        this.showToast('success', 'Bildirimler', 'Bildirimler kapatƒ±ldƒ±');
                    } else {
                        let permission = Notification.permission;
                        
                        if (permission === 'denied') {
                            this.showPermissionHelp();
                            return;
                        }
                        
                        if (permission === 'default') {
                            permission = await Notification.requestPermission();
                        }
                        
                        if (permission === 'granted') {
                            this.notificationsEnabled = true;
                            this.updateNotificationButton();
                            this.saveData();
                            this.showToast('success', 'Ba≈üarƒ±lƒ±!', 'Browser bildirimleri etkinle≈ütirildi');
                            
                            // Test notification
                            setTimeout(() => {
                                new Notification('Test Bildirimi', {
                                    body: 'Bildirimler ba≈üarƒ±yla etkinle≈ütirildi! üéâ',
                                    icon: '/favicon.ico'
                                });
                            }, 1000);
                        } else {
                            this.showToast('danger', 'Hata!', 'Bildirim izni alƒ±namadƒ±');
                        }
                    }
                } else {
                    this.showToast('danger', 'Hata!', 'Bu tarayƒ±cƒ± bildirimleri desteklemiyor');
                }
            }

            updateNotificationButton() {
                const updateButton = (btn) => {
                    if (!btn) return;
                    
                    if (this.notificationsEnabled) {
                        btn.innerHTML = btn.id.includes('mobile') ? '‚úÖ Bildirim' : '‚úÖ Bildirimler Aktif';
                        btn.className = btn.className.replace('bg-gray-600', 'bg-green-600').replace('hover:bg-gray-700', 'hover:bg-green-700');
                        btn.title = 'Bildirimleri Kapat';
                    } else {
                        btn.innerHTML = btn.id.includes('mobile') ? 'üîî Bildirim' : 'üîî Bildirimler';
                        btn.className = btn.className.replace('bg-green-600', 'bg-gray-600').replace('hover:bg-green-700', 'hover:bg-gray-700');
                        btn.title = 'Bildirimleri A√ß';
                    }
                };
                
                updateButton(document.getElementById('notificationBtn'));
                updateButton(document.getElementById('mobileNotificationBtn'));
            }

            showPermissionHelp() {
                const modal = document.createElement('div');
                modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4';
                modal.innerHTML = `
                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-2xl p-6 max-w-md w-full border border-gray-200 dark:border-gray-700 max-h-[90vh] overflow-y-auto">
                        <div class="text-center mb-6">
                            <div class="w-16 h-16 bg-red-100 dark:bg-red-900 rounded-full flex items-center justify-center mx-auto mb-4">
                                <svg class="w-8 h-8 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
                                </svg>
                            </div>
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-2">Bildirim ƒ∞zni Reddedildi</h3>
                            <p class="text-gray-600 dark:text-gray-400 text-sm mb-6">
                                Tarayƒ±cƒ±nƒ±z bildirimleri engellemi≈ü. Manuel olarak a√ßmanƒ±z gerekiyor.
                            </p>
                        </div>
                        
                        <div class="space-y-4 mb-6">
                            <div class="p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg">
                                <h4 class="font-semibold text-blue-900 dark:text-blue-300 mb-2">üåê Chrome/Edge i√ßin:</h4>
                                <ol class="text-sm text-blue-800 dark:text-blue-300 space-y-1">
                                    <li>1. Adres √ßubuƒüundaki üîí kilit simgesine dokunun</li>
                                    <li>2. "Bildirimler" ‚Üí "ƒ∞zin Ver" se√ßin</li>
                                    <li>3. Sayfayƒ± yenileyin</li>
                                </ol>
                            </div>
                            
                            <div class="p-4 bg-orange-50 dark:bg-orange-900/20 rounded-lg">
                                <h4 class="font-semibold text-orange-900 dark:text-orange-300 mb-2">ü¶ä Firefox i√ßin:</h4>
                                <ol class="text-sm text-orange-800 dark:text-orange-300 space-y-1">
                                    <li>1. Adres √ßubuƒüundaki üõ°Ô∏è simgeye dokunun</li>
                                    <li>2. "Bildirimler" ayarƒ±nƒ± deƒüi≈ütirin</li>
                                    <li>3. Sayfayƒ± yenileyin</li>
                                </ol>
                            </div>
                            
                            <div class="p-4 bg-purple-50 dark:bg-purple-900/20 rounded-lg">
                                <h4 class="font-semibold text-purple-900 dark:text-purple-300 mb-2">üì± Mobil i√ßin:</h4>
                                <ol class="text-sm text-purple-800 dark:text-purple-300 space-y-1">
                                    <li>1. Tarayƒ±cƒ± ayarlarƒ± ‚Üí Site ayarlarƒ±</li>
                                    <li>2. Bu siteyi bulun</li>
                                    <li>3. "Bildirimler" izinini a√ßƒ±n</li>
                                </ol>
                            </div>
                        </div>
                        
                        <div class="flex space-x-3">
                            <button onclick="window.location.reload()" class="flex-1 mobile-button px-4 py-3 bg-primary hover:bg-primary/90 text-white rounded-lg font-medium transition-colors">
                                üîÑ Sayfayƒ± Yenile
                            </button>
                            <button onclick="this.closest('.fixed').remove()" class="flex-1 mobile-button px-4 py-3 bg-gray-500 hover:bg-gray-600 text-white rounded-lg font-medium transition-colors">
                                ‚ùå Kapat
                            </button>
                        </div>
                        
                        <p class="text-xs text-gray-500 dark:text-gray-400 text-center mt-4">
                            üí° ƒ∞pucu: Ses bildirimleri her zaman aktif kalƒ±r
                        </p>
                    </div>
                `;
                
                document.body.appendChild(modal);
                
                setTimeout(() => {
                    if (modal.parentNode) {
                        modal.remove();
                    }
                }, 20000);
            }

            showNotification(signal) {
                if (!this.notificationsEnabled) return;

                const notification = new Notification(`${signal.type} Sinyali - ${signal.symbol}`, {
                    body: `Fiyat: $${signal.price.toLocaleString()}\nZaman: ${signal.timestamp}`,
                    icon: '/favicon.ico',
                    tag: signal.symbol,
                    vibrate: [200, 100, 200]
                });

                setTimeout(() => notification.close(), 8000);
            }

            updateCombinedSignalsUI() {
                // Update statistics
                document.getElementById('successfulSignals').textContent = this.signalStats.successful;
                document.getElementById('failedSignals').textContent = this.signalStats.failed;
                document.getElementById('pendingSignals').textContent = this.signalStats.pending;
                
                const total = this.signalStats.successful + this.signalStats.failed;
                const winRate = total > 0 ? (this.signalStats.successful / total * 100) : 0;
                document.getElementById('winRate').textContent = `${winRate.toFixed(1)}%`;
                document.getElementById('totalPnL').textContent = `${this.signalStats.totalPnL >= 0 ? '+' : ''}$${this.signalStats.totalPnL.toFixed(2)}`;
                
                if (this.allSignals.length > 0) {
                    // Update latest signal
                    const latestSignal = this.allSignals[0];
                    const latestSignalEl = document.getElementById('latestSignalCombined');
                    const signalColor = latestSignal.type === 'BUY' ? 'text-green-600' : 'text-red-600';
                    const signalBg = latestSignal.type === 'BUY' ? 'bg-green-100 dark:bg-green-900' : 'bg-red-100 dark:bg-red-900';
                    
                    let statusIcon = '';
                    if (latestSignal.status === 'successful') statusIcon = '‚úÖ';
                    else if (latestSignal.status === 'failed') statusIcon = '‚ùå';
                    else statusIcon = '‚è≥';
                    
                    latestSignalEl.innerHTML = `
                        <div class="${signalBg} rounded-lg p-4 signal-animation">
                            <div class="flex items-center justify-center space-x-2 mb-2">
                                <div class="text-2xl font-bold ${signalColor}">${latestSignal.type}</div>
                                <span class="text-lg">${statusIcon}</span>
                            </div>
                            <div class="text-sm text-gray-600 dark:text-gray-400">${latestSignal.symbol}</div>
                            <div class="font-mono text-lg">$${latestSignal.price.toLocaleString()}</div>
                            <div class="text-xs text-gray-500">${latestSignal.timestamp}</div>
                            ${latestSignal.pnl ? `<div class="text-sm font-semibold mt-2 ${latestSignal.pnl >= 0 ? 'text-green-600' : 'text-red-600'}">
                                PnL: ${latestSignal.pnl >= 0 ? '+' : ''}$${latestSignal.pnl.toFixed(2)}
                            </div>` : ''}
                        </div>
                    `;

                    // Update combined history
                    const historyEl = document.getElementById('combinedSignalHistory');
                    const noSignalsEl = document.getElementById('noSignalsMessage');
                    
                    historyEl.innerHTML = '';
                    noSignalsEl.style.display = 'none';
                    
                    this.allSignals.slice(0, 30).forEach(signal => {
                        const signalItem = document.createElement('div');
                        const itemBg = signal.type === 'BUY' ? 'bg-green-100 dark:bg-green-900' : 'bg-red-100 dark:bg-red-900';
                        const itemColor = signal.type === 'BUY' ? 'text-green-600' : 'text-red-600';
                        
                        let statusIcon = '';
                        if (signal.status === 'successful') statusIcon = '‚úÖ';
                        else if (signal.status === 'failed') statusIcon = '‚ùå';
                        else statusIcon = '‚è≥';
                        
                        signalItem.className = `flex justify-between items-center p-3 rounded ${itemBg} mb-2 mobile-card`;
                        signalItem.innerHTML = `
                            <div class="flex-1">
                                <div class="flex items-center space-x-2">
                                    <span class="font-semibold ${itemColor}">${signal.type}</span>
                                    <span class="text-sm text-gray-600 dark:text-gray-400">${signal.symbol}</span>
                                    <span>${statusIcon}</span>
                                </div>
                                <div class="text-xs text-gray-500">${signal.timestamp}</div>
                                ${signal.pnl ? `<div class="text-xs font-semibold ${signal.pnl >= 0 ? 'text-green-600' : 'text-red-600'}">
                                    ${signal.pnl >= 0 ? '+' : ''}$${signal.pnl.toFixed(2)}
                                </div>` : ''}
                            </div>
                            <span class="font-mono text-sm">$${signal.price.toLocaleString()}</span>
                        `;
                        
                        historyEl.appendChild(signalItem);
                    });
                } else {
                    document.getElementById('noSignalsMessage').style.display = 'block';
                }
            }

            updateUI() {
                const pairCount = this.pairs.size;
                document.getElementById('activePairsCount').textContent = `${pairCount} √ßift`;
                
                const noPairsMsg = document.getElementById('noPairsMessage');
                noPairsMsg.style.display = pairCount === 0 ? 'block' : 'none';
                
                // Update profitability indicator
                const profitabilityEl = document.getElementById('profitability');
                const totalPnL = this.signalStats.totalPnL;
                const pnlPercent = totalPnL !== 0 ? (totalPnL / 1000 * 100) : 0; // Assuming $1000 base
                
                profitabilityEl.textContent = `${totalPnL >= 0 ? '+' : ''}${pnlPercent.toFixed(1)}%`;
                profitabilityEl.className = `text-xs ${totalPnL >= 0 ? 'bg-green-100 dark:bg-green-900 text-green-600' : 'bg-red-100 dark:bg-red-900 text-red-600'} px-2 py-0.5 rounded-full`;
            }
        }

        // Enhanced Individual Pair Tracker with mobile optimizations
        class EnhancedPairTracker {
            constructor(symbol, interval, emaShort, emaLong, parentApp) {
                this.symbol = symbol;
                this.interval = interval;
                this.emaShort = emaShort;
                this.emaLong = emaLong;
                this.parentApp = parentApp;
                
                this.ws = null;
                this.priceData = [];
                this.emaShortData = [];
                this.emaLongData = [];
                this.pairKey = `${symbol}_${interval}_${emaShort}_${emaLong}`;
                this.signalCount = 0;
                this.lastSignalType = null;
                this.performance = 0;
                this.volume24h = 0;
                
                this.connect();
                this.fetchInitialData();
            }

            async fetchInitialData() {
                try {
                    // Fetch 24h ticker data
                    const response = await fetch(`https://api.binance.com/api/v3/ticker/24hr?symbol=${this.symbol.toUpperCase()}`);
                    const data = await response.json();
                    
                    this.volume24h = parseFloat(data.volume);
                    const priceChange = parseFloat(data.priceChangePercent);
                    
                    // Update UI
                    const volumeEl = document.getElementById(`volume_${this.pairKey}`);
                    const changeEl = document.getElementById(`change_${this.pairKey}`);
                    const performanceEl = document.getElementById(`performance_${this.pairKey}`);
                    
                    if (volumeEl) volumeEl.textContent = `Vol: ${(this.volume24h / 1000000).toFixed(1)}M`;
                    if (changeEl) {
                        changeEl.textContent = `${priceChange >= 0 ? '+' : ''}${priceChange.toFixed(2)}%`;
                        changeEl.className = `font-mono ${priceChange >= 0 ? 'text-green-600' : 'text-red-600'}`;
                    }
                    if (performanceEl) {
                        performanceEl.className = `absolute top-2 right-2 w-3 h-3 rounded-full ${
                            priceChange > 2 ? 'performance-positive' : 
                            priceChange < -2 ? 'performance-negative' : 
                            'performance-neutral'
                        }`;
                    }
                    
                } catch (error) {
                    console.error('Failed to fetch initial data:', error);
                }
            }

            connect() {
                this.updateStatus('connecting', 'Baƒülanƒ±yor...');
                
                if (this.ws) {
                    this.ws.close();
                }

                const stream = `${this.symbol}@kline_${this.interval}`;
                this.ws = new WebSocket(`wss://stream.binance.com:9443/ws/${stream}`);

                this.ws.onopen = () => {
                    this.updateStatus('connected', 'Canlƒ±');
                };

                this.ws.onmessage = (event) => {
                    const data = JSON.parse(event.data);
                    this.handleKlineData(data);
                };

                this.ws.onerror = () => {
                    this.updateStatus('error', 'Hata');
                };

                this.ws.onclose = () => {
                    this.updateStatus('disconnected', 'Kesildi');
                    setTimeout(() => this.connect(), 5000);
                };
            }

            reconnect() {
                this.priceData = [];
                this.emaShortData = [];
                this.emaLongData = [];
                this.connect();
            }

            disconnect() {
                if (this.ws) {
                    this.ws.close();
                    this.ws = null;
                }
            }

            handleKlineData(data) {
                if (!data.k) return;

                const kline = data.k;
                const price = parseFloat(kline.c);

                // Update price display with animation
                const priceEl = document.getElementById(`price_${this.pairKey}`);
                if (priceEl) {
                    const oldPrice = parseFloat(priceEl.textContent.replace('$', '').replace(',', ''));
                    priceEl.textContent = `$${price.toLocaleString()}`;
                    
                    // Add price change animation
                    if (oldPrice && oldPrice !== price) {
                        priceEl.classList.remove('text-green-600', 'text-red-600');
                        priceEl.classList.add(price > oldPrice ? 'text-green-600' : 'text-red-600');
                        
                        setTimeout(() => {
                            priceEl.classList.remove('text-green-600', 'text-red-600');
                        }, 1000);
                    }
                }

                // Add to price data
                this.priceData.push(price);
                if (this.priceData.length > 200) {
                    this.priceData.shift();
                }

                // Calculate EMAs
                this.calculateEMAs();
                this.checkSignals();
            }

            calculateEMAs() {
                if (this.priceData.length < this.emaLong) return;

                // Calculate EMA Short
                const emaShort = this.calculateEMA(this.priceData, this.emaShort);
                this.emaShortData.push(emaShort);

                // Calculate EMA Long
                const emaLong = this.calculateEMA(this.priceData, this.emaLong);
                this.emaLongData.push(emaLong);

                // Keep only necessary data
                if (this.emaShortData.length > 100) {
                    this.emaShortData.shift();
                }
                if (this.emaLongData.length > 100) {
                    this.emaLongData.shift();
                }

                // Update UI
                const emaShortEl = document.getElementById(`ema_short_${this.pairKey}`);
                const emaLongEl = document.getElementById(`ema_long_${this.pairKey}`);
                
                if (emaShortEl) emaShortEl.textContent = `$${emaShort.toLocaleString()}`;
                if (emaLongEl) emaLongEl.textContent = `$${emaLong.toLocaleString()}`;
            }

            calculateEMA(data, period) {
                const multiplier = 2 / (period + 1);
                let ema = data[0];

                for (let i = 1; i < data.length; i++) {
                    ema = (data[i] * multiplier) + (ema * (1 - multiplier));
                }

                return ema;
            }

            checkSignals() {
                if (this.emaShortData.length < 2 || this.emaLongData.length < 2) return;

                const currentEmaShort = this.emaShortData[this.emaShortData.length - 1];
                const previousEmaShort = this.emaShortData[this.emaShortData.length - 2];
                const currentEmaLong = this.emaLongData[this.emaLongData.length - 1];
                const previousEmaLong = this.emaLongData[this.emaLongData.length - 2];

                let signal = null;

                // Buy signal: EMA Short crosses above EMA Long
                if (previousEmaShort < previousEmaLong && currentEmaShort > currentEmaLong) {
                    signal = 'BUY';
                }
                // Sell signal: EMA Short crosses below EMA Long
                else if (previousEmaShort > previousEmaLong && currentEmaShort < currentEmaLong) {
                    signal = 'SELL';
                }

                if (signal) {
                    this.addSignal(signal);
                }
            }

            addSignal(type) {
                const timestamp = new Date().toLocaleString('tr-TR');
                const price = this.priceData[this.priceData.length - 1];
                
                const signalData = {
                    type,
                    price,
                    timestamp,
                    symbol: this.symbol.toUpperCase(),
                    interval: this.interval,
                    emaShort: this.emaShort,
                    emaLong: this.emaLong,
                    volume: this.volume24h,
                    strength: this.calculateSignalStrength()
                };

                this.signalCount++;
                this.lastSignalType = type;

                // Update pair card signal display with enhanced animation
                const signalEl = document.getElementById(`signal_${this.pairKey}`);
                const signalsCountEl = document.getElementById(`signals_count_${this.pairKey}`);
                
                if (signalEl) {
                    const signalColor = type === 'BUY' ? 'text-green-600' : 'text-red-600';
                    const signalBg = type === 'BUY' ? 'bg-green-100 dark:bg-green-900' : 'bg-red-100 dark:bg-red-900';
                    
                    signalEl.innerHTML = `
                        <div class="${signalBg} rounded px-3 py-2 signal-animation">
                            <div class="flex items-center justify-center space-x-2">
                                <span class="font-bold ${signalColor}">${type}</span>
                                <span class="text-xs opacity-75">Strength: ${signalData.strength}/10</span>
                            </div>
                            <div class="text-xs text-gray-500 mt-1">${timestamp.split(' ')[1]}</div>
                        </div>
                    `;
                    
                    // Add mobile vibration
                    if ('vibrate' in navigator) {
                        navigator.vibrate([100, 50, 100]);
                    }
                }
                
                if (signalsCountEl) {
                    signalsCountEl.textContent = `${this.signalCount} signals`;
                }

                // Add to parent app's signal collection
                this.parentApp.addSignal(signalData);
            }

            calculateSignalStrength() {
                // Simple signal strength calculation based on EMA divergence
                if (this.emaShortData.length < 2 || this.emaLongData.length < 2) return 5;
                
                const currentEmaShort = this.emaShortData[this.emaShortData.length - 1];
                const currentEmaLong = this.emaLongData[this.emaLongData.length - 1];
                const divergence = Math.abs(currentEmaShort - currentEmaLong) / currentEmaLong;
                
                // Convert divergence to 1-10 scale
                const strength = Math.min(10, Math.max(1, Math.round(divergence * 100 * 5)));
                return strength;
            }

            updateStatus(status, text) {
                const statusEl = document.getElementById(`status_${this.pairKey}`);
                if (!statusEl) return;
                
                const colors = {
                    connecting: 'bg-yellow-500',
                    connected: 'bg-green-500',
                    error: 'bg-red-500',
                    disconnected: 'bg-gray-500'
                };

                statusEl.innerHTML = `
                    <span class="w-2 h-2 ${colors[status]} rounded-full inline-block"></span>
                    ${text}
                `;
            }
        }

        // Initialize enhanced app
        initializeTheme();
        
        // Make app globally available for onclick handlers
        window.multiPairApp = new AdvancedMultiPairTradingSignals();
        window.realTimePriceChart = new AdvancedRealTimePriceChart();

        // Update chart theme when theme changes
        document.getElementById('themeToggle').addEventListener('click', () => {
            setTimeout(() => {
                window.realTimePriceChart.updateTheme();
            }, 100);
        });

        document.getElementById('mobileThemeToggle').addEventListener('click', () => {
            setTimeout(() => {
                window.realTimePriceChart.updateTheme();
            }, 100);
        });

        // Technical Indicators Management
        window.toggleIndicator = function(indicator) {
            const checkbox = document.getElementById(`${indicator}Enabled`);
            const toggle = checkbox.nextElementSibling;
            const settings = document.getElementById(`${indicator}Settings`);
            
            const isEnabled = !checkbox.checked;
            checkbox.checked = isEnabled;
            
            if (isEnabled) {
                toggle.classList.add('active');
                settings.style.display = 'grid';
            } else {
                toggle.classList.remove('active');
                settings.style.display = 'none';
            }
        };

        // Initialize technical indicators on load
        document.addEventListener('DOMContentLoaded', function() {
            // Set default EMA toggle to active
            const emaToggle = document.querySelector('#emaEnabled').nextElementSibling;
            emaToggle.classList.add('active');

            // Add event listeners for range sliders
            const sliders = [
                { id: 'emaShortRange', value: 'emaShortValue' },
                { id: 'emaLongRange', value: 'emaLongValue' },
                { id: 'bollingerPeriod', value: 'bollingerPeriodValue' },
                { id: 'bollingerDeviation', value: 'bollingerDeviationValue' },
                { id: 'rsiPeriod', value: 'rsiPeriodValue' },
                { id: 'rsiOverbought', value: 'rsiOverboughtValue' },
                { id: 'rsiOversold', value: 'rsiOversoldValue' },
                { id: 'macdFast', value: 'macdFastValue' },
                { id: 'macdSlow', value: 'macdSlowValue' },
                { id: 'macdSignal', value: 'macdSignalValue' }
            ];

            sliders.forEach(slider => {
                const element = document.getElementById(slider.id);
                const valueElement = document.getElementById(slider.value);
                
                if (element && valueElement) {
                    element.addEventListener('input', function() {
                        valueElement.textContent = this.value;
                        // Update corresponding inputs for EMA
                        if (slider.id === 'emaShortRange') {
                            document.getElementById('emaShort').value = this.value;
                        } else if (slider.id === 'emaLongRange') {
                            document.getElementById('emaLong').value = this.value;
                        }
                    });
                }
            });

            // Add apply settings button functionality
            document.getElementById('applyIndicatorSettings').addEventListener('click', function() {
                const enabledIndicators = [];
                
                if (document.getElementById('emaEnabled').checked) {
                    enabledIndicators.push('EMA');
                }
                if (document.getElementById('bollingerEnabled').checked) {
                    enabledIndicators.push('Bollinger Bands');
                }
                if (document.getElementById('rsiEnabled').checked) {
                    enabledIndicators.push('RSI');
                }
                if (document.getElementById('macdEnabled').checked) {
                    enabledIndicators.push('MACD');
                }

                multiPairApp.showToast('success', '‚ú® Ayarlar Uygulandƒ±!', 
                    `${enabledIndicators.length} indikat√∂r aktif: ${enabledIndicators.join(', ')}`);
                
                // Here you would apply the settings to all pairs
                multiPairApp.applyIndicatorSettings();
            });
        });

        // Extended MultiPairTradingSignals class with indicator support
        AdvancedMultiPairTradingSignals.prototype.applyIndicatorSettings = function() {
            const settings = {
                ema: {
                    enabled: document.getElementById('emaEnabled').checked,
                    short: parseInt(document.getElementById('emaShortRange').value),
                    long: parseInt(document.getElementById('emaLongRange').value)
                },
                bollinger: {
                    enabled: document.getElementById('bollingerEnabled').checked,
                    period: parseInt(document.getElementById('bollingerPeriod').value),
                    deviation: parseFloat(document.getElementById('bollingerDeviation').value)
                },
                rsi: {
                    enabled: document.getElementById('rsiEnabled').checked,
                    period: parseInt(document.getElementById('rsiPeriod').value),
                    overbought: parseInt(document.getElementById('rsiOverbought').value),
                    oversold: parseInt(document.getElementById('rsiOversold').value)
                },
                macd: {
                    enabled: document.getElementById('macdEnabled').checked,
                    fast: parseInt(document.getElementById('macdFast').value),
                    slow: parseInt(document.getElementById('macdSlow').value),
                    signal: parseInt(document.getElementById('macdSignal').value)
                }
            };

            // Apply to all pairs
            this.pairs.forEach(pairTracker => {
                if (pairTracker.applyIndicatorSettings) {
                    pairTracker.applyIndicatorSettings(settings);
                }
            });

            this.saveData();
        };

        // Update alerts display to show empty state properly
        AdvancedMultiPairTradingSignals.prototype.updateAlertsDisplay = function() {
            const alertsEl = document.getElementById('activeAlerts');
            const noAlertsEl = document.getElementById('noAlertsMessage');
            
            alertsEl.innerHTML = '';
            
            if (this.alerts.length === 0) {
                noAlertsEl.style.display = 'block';
                return;
            }
            
            noAlertsEl.style.display = 'none';
            
            this.alerts.forEach(alert => {
                const alertEl = document.createElement('div');
                alertEl.className = 'alert-card rounded-lg p-3 flex justify-between items-center';
                alertEl.innerHTML = `
                    <div class="flex items-center space-x-3">
                        <div class="w-8 h-8 bg-orange-100 dark:bg-orange-900 rounded-full flex items-center justify-center">
                            <span class="text-orange-600 text-sm">üîî</span>
                        </div>
                        <div>
                            <div class="font-semibold text-orange-900 dark:text-orange-100">${alert.symbol}</div>
                            <div class="text-sm text-orange-700 dark:text-orange-300">$${alert.targetPrice.toLocaleString()}</div>
                        </div>
                    </div>
                    <button onclick="multiPairApp.removeAlert(${alert.id})" class="p-1 text-orange-600 hover:text-orange-700 bg-orange-100 dark:bg-orange-800 rounded transition-colors">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                `;
                alertsEl.appendChild(alertEl);
            });
        };

        // Service Worker for PWA functionality
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/sw.js').catch(console.error);
        }
    </script>
</body>
</html>
